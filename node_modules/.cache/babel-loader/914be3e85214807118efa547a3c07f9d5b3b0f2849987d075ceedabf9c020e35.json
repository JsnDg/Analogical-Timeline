{"ast":null,"code":"var _jsxFileName = \"/Users/jasonding/Desktop/RAG-example/src/components/TreePlotVisualization.jsx\",\n  _s2 = $RefreshSig$();\n// ============== 段落1：导入依赖 ==============\nimport React, { useState, useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport data_summary from './data_summary.json'; // 确保有 data_summary.json\n\n// ============== 段落2：定义 TreePlotVisualization 组件 ==============\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst TreePlotVisualization = () => {\n  _s2();\n  var _s = $RefreshSig$();\n  // ============== 段落2.1：定义所有 state 变量 ==============\n  const [showTree, setShowTree] = useState(true); // true: Exploration View, false: Evaluation View\n  const [nodes, setNodes] = useState([]);\n  const [links, setLinks] = useState([]);\n  const [hoveredNode, setHoveredNode] = useState(null);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [userInput, setUserInput] = useState('');\n  const [analysisIntent, setAnalysisIntent] = useState('');\n  const [isAnalysisSubmitted, setIsAnalysisSubmitted] = useState(false);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [isEvaluating, setIsEvaluating] = useState(false);\n  const [error, setError] = useState(null);\n  const svgRef = useRef(null);\n  const [hypothesesList, setHypothesesList] = useState([]);\n  // **新增**: 用于存放\"拖拽后生成的 ghostNode + 悬浮确认按钮信息\"\n  const [pendingChange, setPendingChange] = useState(null);\n  const [isAddingCustom, setIsAddingCustom] = useState(false);\n  const [customHypothesis, setCustomHypothesis] = useState({\n    title: '',\n    content: ''\n  });\n\n  // X/Y 轴指标（仅在 Evaluation View 用）\n  const [xAxisMetric, setXAxisMetric] = useState('feasibilityScore');\n  const [yAxisMetric, setYAxisMetric] = useState('noveltyScore');\n\n  // ID 计数器\n  const idCounterRef = useRef(0);\n  const generateUniqueId = () => {\n    idCounterRef.current += 1;\n    return `node-${idCounterRef.current}`;\n  };\n\n  // 配色映射\n  const colorMap = {\n    root: '#4C84FF',\n    simple: '#45B649',\n    complex: '#FF6B6B'\n  };\n\n  // ============== 段落3：评估假设（evaluateHypotheses） ==============\n  const evaluateHypotheses = async hypotheses => {\n    setIsEvaluating(true);\n    setError(null);\n    try {\n      const prompt = `For the following hypotheses, rank **each one individually** based on novelty, feasibility, and impact.\n      Novelty is judged by whether the hypotheses challenges traditional assumptions, propose innovative approaches, or explore under-researched areas will score higher in novelty. Less novel hypotheses include those that replicate well-known findings or extend existing studies with minimal new insights.\n      Feasibility is judged by whether the hypothesis can be represented by the dataset described in the data summary.\n      Impact assesses how the hypotheses addresses critical or emerging issues, influence policy or decision-making, or provide insights into major societal, economic, or scientific challenges. Hypotheses with lower impact are narrower in scope or contribute incremental knowledge without broader implications.\n      For each hypothesis, provide its rank (1 being the highest) in terms of novelty, feasibility, and impact.\n      Also, provide the ranking reasons for each hypothesis.\n      **Ensure that you include all hypotheses in your evaluation and do not combine or omit any.**\n      **No two hypotheses should have the same rank in any category. Assign unique ranks to each hypothesis in each category to avoid overlaps.**\n      Return the results in JSON format as an array of objects with the following fields:\n      - id\n      - novelty_rank\n      - novelty_rank_reason\n      - feasibility_rank\n      - feasibility_rank_reason\n      - impact_rank\n      - impact_rank_reason\n\nHere are the hypotheses:\n${JSON.stringify(hypotheses)}\n\nData summary: ${JSON.stringify(data_summary)}\n\nPlease provide only the JSON array in your response.`;\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [{\n            role: 'system',\n            content: 'You are a data scientist.'\n          }, {\n            role: 'user',\n            content: prompt\n          }],\n          max_tokens: 2000\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n      let evaluatedHypotheses;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          evaluatedHypotheses = JSON.parse(jsonMatch[0]);\n        } else {\n          evaluatedHypotheses = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse evaluated hypotheses JSON from the assistant's reply.\");\n      }\n      if (evaluatedHypotheses.length !== hypotheses.length) {\n        throw new Error(`Mismatch in number of evaluated hypotheses. Expected ${hypotheses.length}, but got ${evaluatedHypotheses.length}.`);\n      }\n\n      // rank -> score\n      const rankToScore = (rank, total) => {\n        const maxScore = 90;\n        const minScore = 10;\n        const scoreRange = maxScore - minScore;\n        // 分数从高到低\n        const score = maxScore - (rank - 1) * scoreRange / (total - 1);\n        return Math.round(score);\n      };\n      setNodes(prevNodes => prevNodes.map(node => {\n        const evalHypo = evaluatedHypotheses.find(h => h.id === node.id);\n        if (evalHypo) {\n          const totalHypotheses = hypotheses.length;\n          const noveltyScore = rankToScore(evalHypo.novelty_rank, totalHypotheses);\n          const feasibilityScore = rankToScore(evalHypo.feasibility_rank, totalHypotheses);\n          const impactScore = rankToScore(evalHypo.impact_rank, totalHypotheses);\n          return {\n            ...node,\n            noveltyScore,\n            feasibilityScore,\n            impactScore,\n            noveltyReason: evalHypo.novelty_rank_reason || '(No reason provided)',\n            feasibilityReason: evalHypo.feasibility_rank_reason || '(No reason provided)',\n            impactReason: evalHypo.impact_rank_reason || '(No reason provided)'\n          };\n        }\n        return node;\n      }));\n    } catch (err) {\n      console.error('Error evaluating hypotheses:', err);\n      setError(err.message);\n    } finally {\n      setIsEvaluating(false);\n    }\n  };\n\n  // ============== 段落4：分析意图提交处理 (handleAnalysisIntentSubmit) ==============\n  const handleAnalysisIntentSubmit = async e => {\n    e.preventDefault();\n    if (!analysisIntent.trim()) return;\n    setIsGenerating(true);\n    setError(null);\n    try {\n      const prompt = `Based on the following analysis intent and data, generate exactly three initial hypotheses. For each hypothesis, provide a two-word title and a detailed content. Return the hypotheses in JSON format as an array of objects with \"title\" and \"content\" fields.\n\nAnalysis Intent: ${analysisIntent}\n\nData: ${JSON.stringify(data_summary)}\n\nPlease provide only the JSON array in your response.`;\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [{\n            role: 'system',\n            content: 'You are a data scientist.'\n          }, {\n            role: 'user',\n            content: prompt\n          }],\n          max_tokens: 500\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n      let hypothesesArray;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          hypothesesArray = JSON.parse(jsonMatch[0]);\n        } else {\n          hypothesesArray = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse hypotheses JSON from the assistant's reply.\");\n      }\n      const hypotheses = hypothesesArray.slice(0, 3);\n      const hypothesesWithId = hypotheses.map(hyp => {\n        const id = generateUniqueId();\n        return {\n          id,\n          ...hyp\n        };\n      });\n      const updatedHypothesesList = [...hypothesesList, ...hypothesesWithId];\n      setHypothesesList(updatedHypothesesList);\n\n      // Root node\n      const rootNode = {\n        id: 'root',\n        level: 0,\n        title: analysisIntent,\n        content: analysisIntent,\n        type: 'root',\n        x: 0,\n        y: 0\n      };\n\n      // Child nodes\n      const childSpacing = 200;\n      const totalWidth = (hypotheses.length - 1) * childSpacing;\n      const startX = rootNode.x - totalWidth / 2;\n      const childNodes = hypothesesWithId.map((hyp, i) => ({\n        id: hyp.id,\n        level: 1,\n        title: hyp.title.trim(),\n        content: hyp.content.trim(),\n        type: 'complex',\n        x: startX + i * childSpacing,\n        y: rootNode.y + 150\n      }));\n      const newNodes = [rootNode, ...childNodes];\n      const newLinks = childNodes.map(nd => ({\n        source: rootNode.id,\n        target: nd.id\n      }));\n      setNodes(newNodes);\n      setLinks(newLinks);\n      setAnalysisIntent('');\n      setIsAnalysisSubmitted(true);\n\n      // 评估\n      await evaluateHypotheses(updatedHypothesesList);\n      setIsGenerating(false);\n    } catch (err) {\n      console.error('Error generating initial hypotheses:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    }\n  };\n\n  // ============== 段落5：生成子节点 (generateChildNodes) ==============\n  const generateChildNodes = async () => {\n    if (!selectedNode) return;\n    setIsGenerating(true);\n    setError(null);\n    try {\n      const prompt = `Based on the following node content and data, generate exactly three new hypotheses. For each hypothesis, provide a two-word title and a detailed content. Return the hypotheses in JSON format as an array of objects with \"title\" and \"content\" fields.\n\nNode Content: ${selectedNode.content}\n\nData: ${JSON.stringify(data_summary)}\n\nAdditional Context: ${userInput}\n\nPlease provide only the JSON array in your response.`;\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [{\n            role: 'system',\n            content: 'You are a data scientist.'\n          }, {\n            role: 'user',\n            content: prompt\n          }],\n          max_tokens: 500\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n      let hypothesesArray;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          hypothesesArray = JSON.parse(jsonMatch[0]);\n        } else {\n          hypothesesArray = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse hypotheses JSON from the assistant's reply.\");\n      }\n      const hypotheses = hypothesesArray.slice(0, 3);\n      const newHypothesesWithId = hypotheses.map(hyp => {\n        const id = generateUniqueId();\n        return {\n          id,\n          ...hyp\n        };\n      });\n      const updatedHypothesesList = [...hypothesesList, ...newHypothesesWithId];\n      setHypothesesList(updatedHypothesesList);\n\n      // 布局\n      const childSpacing = 200;\n      const totalWidth = (hypotheses.length - 1) * childSpacing;\n      const startX = selectedNode.x - totalWidth / 2;\n      const newNodes = newHypothesesWithId.map((hyp, i) => ({\n        id: hyp.id,\n        level: selectedNode.level + 1,\n        title: hyp.title.trim(),\n        content: hyp.content.trim(),\n        type: 'complex',\n        x: startX + i * childSpacing + Math.random() * 20 - 10,\n        y: selectedNode.y + 150 + Math.random() * 20 - 10\n      }));\n      const newLinks = newNodes.map(nd => ({\n        source: selectedNode.id,\n        target: nd.id\n      }));\n      setNodes(prev => [...prev, ...newNodes]);\n      setLinks(prev => [...prev, ...newLinks]);\n\n      // 评估\n      await evaluateHypotheses(updatedHypothesesList);\n      setIsGenerating(false);\n      setUserInput('');\n    } catch (err) {\n      console.error('Error generating hypotheses:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    }\n  };\n\n  // ============== 段落6：根据拖拽修改假设 (modifyHypothesisBasedOnModifications) ==============\n  // ============== 段落6：修改开始 ==============\n  const modifyHypothesisBasedOnModifications = async (originalNode, ghostNode, modifications, behindNode) => {\n    setError(null);\n    try {\n      setIsGenerating(true);\n\n      // 根据每个指标和对应的 increase/decrease，拼接更灵活的描述\n      let instructionLines = [];\n      const behindNodeContent = behindNode ? behindNode.content : '(No behind node found)';\n      modifications.forEach(mod => {\n        const metricName = mod.metric === 'noveltyScore' ? 'Novelty' : mod.metric === 'feasibilityScore' ? 'Feasibility' : 'Impact';\n        const direction = mod.direction === 'increase' ? 'increasing' : 'decreasing';\n        const line = `by ${direction} its ${metricName} with ${direction === 'increasing' ? 'more' : 'less'} ${metricName.toLowerCase()} than this hypothesis:\\n${behindNodeContent}`;\n        instructionLines.push(line);\n      });\n      const instructionsText = instructionLines.map((line, idx) => {\n        if (idx === 0) return `Modify this hypothesis ${line}`;\n        return `And ${line}`;\n      }).join('\\n\\n');\n      const prompt = `\n  ${instructionsText}\n\n  Keep its main idea intact, but focus on adjusting the degree of novelty, feasibility, and/or impact as requested.\n\n  Original hypothesis:\n  ${originalNode.content}\n\n  Dataset summary: ${JSON.stringify(data_summary)}\n\n  Please provide only the modified hypothesis content in your response.\n      `.trim();\n      console.log('modify prompt:', prompt);\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [{\n            role: 'system',\n            content: 'You are a data scientist.'\n          }, {\n            role: 'user',\n            content: prompt\n          }],\n          max_tokens: 500\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n      ghostNode.content = assistantReply;\n      ghostNode.isModified = true;\n      ghostNode.previousState = originalNode;\n      ghostNode.isGhost = false;\n      const newHypothesis = {\n        id: ghostNode.id,\n        title: ghostNode.title,\n        content: assistantReply\n      };\n      setHypothesesList(prevList => [...prevList, newHypothesis]);\n      setNodes(prevNodes => prevNodes.map(n => n.id === ghostNode.id ? ghostNode : n));\n      setIsGenerating(false);\n      setIsEvaluating(true);\n      await evaluateHypotheses([...hypothesesList, newHypothesis]);\n    } catch (err) {\n      console.error('Error modifying hypothesis:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    } finally {\n      setIsEvaluating(false);\n    }\n  };\n  // ============== 段落6：修改结束 ==============\n\n  // ============== 段落7：节点点击/悬浮/离开事件处理 ==============\n  const handleNodeClick = node => {\n    setSelectedNode(prev => (prev === null || prev === void 0 ? void 0 : prev.id) === node.id ? null : node);\n  };\n  const handleNodeHover = (event, d) => {\n    setHoveredNode(d);\n    d3.select(event.currentTarget).raise();\n  };\n  const handleNodeLeave = () => {\n    setHoveredNode(null);\n  };\n\n  // ============== 段落8：D3 渲染逻辑 useEffect ==============\n  useEffect(() => {\n    if (!svgRef.current) return;\n    const width = 800;\n    const height = 600;\n\n    // 清空 SVG\n    d3.select(svgRef.current).selectAll('*').remove();\n    if (showTree) {\n      // ------------------- Exploration (Tree) View --------------------\n      const svg = d3.select(svgRef.current).attr('width', width).attr('height', height);\n\n      // 卡片背景\n      svg.append('rect').attr('x', 2).attr('y', 2).attr('width', width - 4).attr('height', height - 4).attr('rx', 8).attr('ry', 8).style('fill', '#fff').style('stroke', '#e5e7eb').style('stroke-width', 1).style('filter', 'drop-shadow(0 4px 6px rgba(0,0,0,0.1))');\n      const g = svg.append('g').attr('transform', `translate(300, 130)`);\n\n      // 连线\n      links.forEach(link => {\n        const source = nodes.find(n => n.id === link.source);\n        const target = nodes.find(n => n.id === link.target);\n        if (source && target) {\n          g.append('path').attr('d', `M ${source.x},${source.y} C ${source.x},${(source.y + target.y) / 2} \n               ${target.x},${(source.y + target.y) / 2} \n               ${target.x},${target.y}`).style('fill', 'none').style('stroke', '#ccc').style('stroke-width', 2);\n        }\n      });\n\n      // 节点\n      const nodeGroups = g.selectAll('.node').data(nodes).enter().append('g').attr('class', 'node').attr('transform', d => `translate(${d.x},${d.y})`);\n      nodeGroups.append('text').attr('dy', 35).attr('text-anchor', 'middle').text(d => d.title).attr('pointer-events', 'none');\n      nodeGroups.append('circle').attr('r', 25).style('fill', d => d.isNewlyGenerated ? '#FFD700' : colorMap[d.type]).style('opacity', d => d.isGhost ? 0.5 : 1).style('stroke', d => {\n        if ((selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.id) === d.id) return '#000';else if ((hoveredNode === null || hoveredNode === void 0 ? void 0 : hoveredNode.id) === d.id) return '#555';else return '#fff';\n      }).style('stroke-width', d => {\n        if ((selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.id) === d.id) return 4;else if ((hoveredNode === null || hoveredNode === void 0 ? void 0 : hoveredNode.id) === d.id) return 3;else return 2;\n      }).style('cursor', 'pointer').on('mouseenter', handleNodeHover).on('mouseleave', handleNodeLeave).on('click', (event, d) => handleNodeClick(d));\n\n      // 在卡片底部放三个颜色标识 (蓝/红/黄)\n      const legendG = svg.append('g').attr('transform', `translate(40, ${height - 40})`);\n      legendG.append('circle').attr('cx', 0).attr('cy', 0).attr('r', 6).style('fill', '#4C84FF');\n      legendG.append('text').attr('x', 14).attr('y', 4).style('font-size', '0.875rem').style('fill', '#374151').text('Intent');\n      legendG.append('circle').attr('cx', 100).attr('cy', 0).attr('r', 6).style('fill', '#FF6B6B');\n      legendG.append('text').attr('x', 110).attr('y', 4).style('font-size', '0.875rem').style('fill', '#374151').text('Original Hypothesis');\n      legendG.append('circle').attr('cx', 270).attr('cy', 0).attr('r', 6).style('fill', '#FFD700');\n      legendG.append('text').attr('x', 284).attr('y', 4).style('font-size', '0.875rem').style('fill', '#374151').text('Modified Hypothesis');\n    } else {\n      // ------------------- Evaluation (Scatter) View --------------------\n      const svg = d3.select(svgRef.current).attr('width', width).attr('height', height);\n\n      // 背景卡片\n      svg.append('rect').attr('x', 2).attr('y', 2).attr('width', width - 4).attr('height', height - 4).attr('rx', 8).attr('ry', 8).style('fill', '#fff').style('stroke', '#e5e7eb').style('stroke-width', 1).style('filter', 'drop-shadow(0 4px 6px rgba(0,0,0,0.1))');\n      const axisFO = svg.append('foreignObject').attr('x', width - 210).attr('y', 20).attr('width', 200).attr('height', 60);\n      axisFO.append('xhtml:div').style('display', 'flex').style('flexDirection', 'column').style('gap', '6px').style('fontSize', '0.875rem').html(`\n        <div style=\"display: flex; flex-direction: column; gap: 10px;\">\n          <div style=\"display: flex; align-items: center;\">\n            <label for=\"xSelect\" style=\"color: #374151; margin-right: 6px;\">X-Axis:</label>\n            <select id=\"xSelect\" \n              style=\"padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; color: #374151;\">\n              <option value=\"noveltyScore\">Novelty</option>\n              <option value=\"feasibilityScore\">Feasibility</option>\n              <option value=\"impactScore\">Impact</option>\n            </select>\n          </div>\n\n          <div style=\"display: flex; align-items: center;\">\n            <label for=\"ySelect\" style=\"color: #374151; margin-right: 6px;\">Y-Axis:</label>\n            <select id=\"ySelect\" \n              style=\"padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; color: #374151;\">\n              <option value=\"noveltyScore\">Novelty</option>\n              <option value=\"feasibilityScore\">Feasibility</option>\n              <option value=\"impactScore\">Impact</option>\n            </select>\n          </div>\n        </div>\n      `);\n      const xSelectElem = document.getElementById('xSelect');\n      const ySelectElem = document.getElementById('ySelect');\n      if (xSelectElem) xSelectElem.value = xAxisMetric;\n      if (ySelectElem) ySelectElem.value = yAxisMetric;\n      if (xSelectElem) {\n        xSelectElem.onchange = e => setXAxisMetric(e.target.value);\n      }\n      if (ySelectElem) {\n        ySelectElem.onchange = e => setYAxisMetric(e.target.value);\n      }\n      const margin = {\n        top: 100,\n        right: 50,\n        bottom: 80,\n        left: 50\n      };\n      const chartWidth = width - margin.left - margin.right;\n      const chartHeight = height - margin.top - margin.bottom;\n      const g = svg.append('g').attr('transform', `translate(${margin.left}, ${margin.top})`);\n      const xScale = d3.scaleLinear().domain([0, 100]).range([0, chartWidth]);\n      const yScale = d3.scaleLinear().domain([0, 100]).range([chartHeight, 0]);\n      const xAxis = d3.axisBottom(xScale).tickValues(d3.range(0, 101, 20)).tickFormat(d3.format('d'));\n      const yAxis = d3.axisLeft(yScale).tickValues(d3.range(0, 101, 20)).tickFormat(d3.format('d'));\n      const xGrid = d3.axisBottom(xScale).tickValues(d3.range(0, 101, 20)).tickSize(-chartHeight).tickFormat('');\n      const yGrid = d3.axisLeft(yScale).tickValues(d3.range(0, 101, 20)).tickSize(-chartWidth).tickFormat('');\n      const xGridG = g.append('g').attr('class', 'x-grid').attr('transform', `translate(0, ${chartHeight})`).call(xGrid);\n      xGridG.selectAll('.domain').remove();\n      xGridG.selectAll('.tick line').style('stroke', '#F1F1F1');\n      const yGridG = g.append('g').attr('class', 'y-grid').call(yGrid);\n      yGridG.selectAll('.domain').remove();\n      yGridG.selectAll('.tick line').style('stroke', '#F1F1F1');\n      g.append('g').attr('transform', `translate(0, ${chartHeight})`).call(xAxis);\n      g.append('g').call(yAxis);\n      g.append('text').attr('x', chartWidth / 2).attr('y', chartHeight + 40).style('text-anchor', 'middle').style('fill', '#374151').style('font-size', '1.2rem').text(xAxisMetric === 'noveltyScore' ? 'Novelty' : xAxisMetric === 'feasibilityScore' ? 'Feasibility' : 'Impact');\n      g.append('text').attr('transform', 'rotate(-90)').attr('x', -chartHeight / 2).attr('y', -30).style('text-anchor', 'middle').style('fill', '#374151').style('font-size', '1.2rem').text(yAxisMetric === 'noveltyScore' ? 'Novelty' : yAxisMetric === 'feasibilityScore' ? 'Feasibility' : 'Impact');\n      const legendEval = svg.append('g').attr('transform', `translate(${margin.left}, ${height - 30})`);\n      legendEval.append('circle').attr('cx', 0).attr('cy', 0).attr('r', 5).style('fill', '#FF6B6B');\n      legendEval.append('text').attr('x', 10).attr('y', 4).style('fontSize', '0.875rem').style('fill', '#374151').text('Original');\n      legendEval.append('circle').attr('cx', 80).attr('cy', 0).attr('r', 5).style('fill', '#FFC300');\n      legendEval.append('text').attr('x', 90).attr('y', 4).style('fontSize', '0.875rem').style('fill', '#374151').text('Modified');\n      const filteredNodes = nodes.filter(d => d[xAxisMetric] !== undefined && d[yAxisMetric] !== undefined);\n      const evaluationLinks = links.filter(link => {\n        const sourceNode = nodes.find(n => n.id === link.source);\n        const targetNode = nodes.find(n => n.id === link.target);\n        return sourceNode && targetNode && targetNode.isModified;\n      });\n      evaluationLinks.forEach(link => {\n        const source = nodes.find(n => n.id === link.source);\n        const target = nodes.find(n => n.id === link.target);\n        if (source && target) {\n          g.append('line').attr('x1', xScale(source[xAxisMetric])).attr('y1', yScale(source[yAxisMetric])).attr('x2', xScale(target[xAxisMetric])).attr('y2', yScale(target[yAxisMetric])).style('stroke', '#ccc').style('stroke-width', 1);\n        }\n      });\n      const nodeGroups = g.selectAll('.node-group').data(filteredNodes).enter().append('g').attr('class', 'node-group').attr('transform', d => `translate(${xScale(d[xAxisMetric])}, ${yScale(d[yAxisMetric])})`).style('cursor', 'pointer').on('mouseenter', handleNodeHover).on('mouseleave', handleNodeLeave).on('click', (event, d) => handleNodeClick(d)).call(d3.drag().on('start', function (event, d) {\n        if (isGenerating || isEvaluating) return;\n        d3.select(this).raise();\n      }).on('drag', function (event, d) {\n        if (isGenerating || isEvaluating) return;\n        const [xx, yy] = d3.pointer(event, g.node());\n        d3.select(this).attr('transform', `translate(${xx}, ${yy})`);\n        d._lastX = xx;\n        d._lastY = yy;\n      }).on('end', function (event, d) {\n        if (isGenerating || isEvaluating) return;\n        let finalX = typeof d._lastX === 'number' ? d._lastX : d3.pointer(event, g.node())[0];\n        let finalY = typeof d._lastY === 'number' ? d._lastY : d3.pointer(event, g.node())[1];\n        const newXMetricValue = xScale.invert(finalX);\n        const newYMetricValue = yScale.invert(finalY);\n        const oldXMetricValue = d[xAxisMetric];\n        const oldYMetricValue = d[yAxisMetric];\n        const deltaX = newXMetricValue - oldXMetricValue;\n        const deltaY = newYMetricValue - oldYMetricValue;\n        delete d._lastX;\n        delete d._lastY;\n        let modifications = [];\n        let behindNodeCandidate = null;\n        if (Math.abs(deltaX) > 5) {\n          modifications.push({\n            metric: xAxisMetric,\n            direction: deltaX > 0 ? 'increase' : 'decrease'\n          });\n          const smallerCandidates = nodes.filter(node => node[xAxisMetric] !== undefined && node.id !== d.id && node[xAxisMetric] < newXMetricValue).sort((a, b) => b[xAxisMetric] - a[xAxisMetric]);\n          if (smallerCandidates[0]) {\n            behindNodeCandidate = smallerCandidates[0];\n          }\n        }\n        if (Math.abs(deltaY) > 5) {\n          modifications.push({\n            metric: yAxisMetric,\n            direction: deltaY > 0 ? 'increase' : 'decrease'\n          });\n          const smallerY = nodes.filter(node => node[yAxisMetric] !== undefined && node.id !== d.id && node[yAxisMetric] < newYMetricValue).sort((a, b) => b[yAxisMetric] - a[yAxisMetric]);\n          if (smallerY[0]) {\n            behindNodeCandidate = smallerY[0] || behindNodeCandidate;\n          }\n        }\n        d3.select(this).attr('transform', `translate(${xScale(d[xAxisMetric])}, ${yScale(d[yAxisMetric])})`);\n        if (modifications.length > 0) {\n          const ghostNodeId = generateUniqueId();\n          const ghostNode = {\n            ...d,\n            id: ghostNodeId,\n            x: d.x,\n            y: d.y,\n            [xAxisMetric]: newXMetricValue,\n            [yAxisMetric]: newYMetricValue,\n            isGhost: true,\n            isNewlyGenerated: true\n          };\n          setNodes(prev => [...prev, ghostNode]);\n          setLinks(prev => [...prev, {\n            source: d.id,\n            target: ghostNodeId\n          }]);\n          setPendingChange({\n            originalNode: d,\n            ghostNode,\n            modifications,\n            behindNode: behindNodeCandidate,\n            screenX: event.sourceEvent.clientX + 10,\n            screenY: event.sourceEvent.clientY + 10\n          });\n        }\n      }));\n      nodeGroups.append('circle').attr('r', 8).style('fill', d => d.isNewlyGenerated ? '#FFD700' : colorMap[d.type]).style('opacity', d => d.isGhost ? 0.5 : 1).style('stroke', d => {\n        if ((selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.id) === d.id) return '#000';else if ((hoveredNode === null || hoveredNode === void 0 ? void 0 : hoveredNode.id) === d.id) return '#555';else return '#fff';\n      }).style('stroke-width', d => {\n        if ((selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.id) === d.id) return 4;else if ((hoveredNode === null || hoveredNode === void 0 ? void 0 : hoveredNode.id) === d.id) return 3;else return 2;\n      });\n    }\n  }, [showTree, nodes, links, selectedNode, hoveredNode, xAxisMetric, yAxisMetric, isGenerating, isEvaluating]);\n\n  // ============== 段落9：Dashboard 相关逻辑 ==============\n  const TopNav = () => {\n    const explorationIcon = /*#__PURE__*/_jsxDEV(\"svg\", {\n      width: \"20\",\n      height: \"20\",\n      viewBox: \"0 0 20 20\",\n      fill: \"none\",\n      xmlns: \"http://www.w3.org/2000/svg\",\n      style: {\n        marginRight: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"g\", {\n        clipPath: \"url(#clip0_119_560)\",\n        children: [/*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M8.52543 15.8306C12.2418 15.8306 15.2546 12.8179 15.2546 9.10148C15.2546 5.38508 12.2418 2.37231 8.52543 2.37231C4.80903 2.37231 1.79626 5.38508 1.79626 9.10148C1.79626 12.8179 4.80903 15.8306 8.52543 15.8306Z\",\n          stroke: \"#A2A2A2\",\n          strokeWidth: \"2\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 927,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M10.7646 6.46654C10.1915 5.89349 9.39988 5.53906 8.5254 5.53906C7.65097 5.53906 6.8593 5.89349 6.28625 6.46654\",\n          stroke: \"#A2A2A2\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 933,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M13.3632 13.9392L16.7219 17.298\",\n          stroke: \"#A2A2A2\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 940,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 926,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"defs\", {\n        children: /*#__PURE__*/_jsxDEV(\"clipPath\", {\n          id: \"clip0_119_560\",\n          children: /*#__PURE__*/_jsxDEV(\"rect\", {\n            width: \"19\",\n            height: \"19\",\n            fill: \"white\",\n            transform: \"translate(0.212891 0.789062)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 950,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 948,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 918,\n      columnNumber: 7\n    }, this);\n    const evaluationIcon = /*#__PURE__*/_jsxDEV(\"svg\", {\n      width: \"20\",\n      height: \"20\",\n      viewBox: \"0 0 20 20\",\n      fill: \"none\",\n      xmlns: \"http://www.w3.org/2000/svg\",\n      style: {\n        marginRight: '8px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"g\", {\n        children: [/*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M2.47949 2.46533V16.7153H16.7295\",\n          stroke: \"#141414\",\n          strokeWidth: \"2\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 966,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fillRule: \"evenodd\",\n          clipRule: \"evenodd\",\n          d: \"M8.02114 9.59025C8.89557 9.59025 9.60447 8.88135 9.60447 8.00692C9.60447 7.13248 8.89557 6.42358 8.02114 6.42358C7.1467 6.42358 6.43781 7.13248 6.43781 8.00692C6.43781 8.88135 7.1467 9.59025 8.02114 9.59025Z\",\n          fill: \"#141414\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 973,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fillRule: \"evenodd\",\n          clipRule: \"evenodd\",\n          d: \"M14.7503 6.42367C15.8434 6.42367 16.7295 5.53755 16.7295 4.4445C16.7295 3.35144 15.8434 2.46533 14.7503 2.46533C13.6573 2.46533 12.7712 3.35144 12.7712 4.4445C12.7712 5.53755 13.6573 6.42367 14.7503 6.42367Z\",\n          fill: \"#141414\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 979,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fillRule: \"evenodd\",\n          clipRule: \"evenodd\",\n          d: \"M6.04199 14.3403C6.69785 14.3403 7.22949 13.8087 7.22949 13.1528C7.22949 12.497 6.69785 11.9653 6.04199 11.9653C5.38614 11.9653 4.85449 12.497 4.85449 13.1528C4.85449 13.8087 5.38614 14.3403 6.04199 14.3403Z\",\n          fill: \"#141414\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fillRule: \"evenodd\",\n          clipRule: \"evenodd\",\n          d: \"M13.167 12.7571C13.8228 12.7571 14.3545 12.2254 14.3545 11.5696C14.3545 10.9137 13.8228 10.3821 13.167 10.3821C12.5111 10.3821 11.9795 10.9137 11.9795 11.5696C11.9795 12.2254 12.5111 12.7571 13.167 12.7571Z\",\n          fill: \"#141414\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 991,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 965,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 957,\n      columnNumber: 7\n    }, this);\n    const tabStyle = {\n      display: 'flex',\n      alignItems: 'center',\n      padding: '10px 16px',\n      cursor: 'pointer',\n      borderRadius: '9999px',\n      transition: 'all 0.2s ease',\n      fontSize: '0.875rem',\n      fontWeight: 500\n    };\n    const explorationActiveStyle = showTree ? {\n      backgroundColor: '#fff',\n      color: '#141414'\n    } : {\n      backgroundColor: 'transparent',\n      color: '#A0AEC0'\n    };\n    const evaluationActiveStyle = !showTree ? {\n      backgroundColor: '#fff',\n      color: '#141414'\n    } : {\n      backgroundColor: 'transparent',\n      color: '#A0AEC0'\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        backgroundColor: '#0F172A',\n        padding: '10px 20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...tabStyle,\n          ...explorationActiveStyle,\n          marginRight: '6px'\n        },\n        onClick: () => setShowTree(true),\n        children: [explorationIcon, \"Exploration View\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1030,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...tabStyle,\n          ...evaluationActiveStyle\n        },\n        onClick: () => setShowTree(false),\n        children: [evaluationIcon, \"Evaluation View\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1036,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1021,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ============== 段落9.1：新的合并卡片组件 ==============\n\n  const HypothesisCard = ({\n    node,\n    showAfter,\n    setShowAfter\n  }) => {\n    const hasPrevious = !!node.previousState;\n    // 如果未被修改过，则直接显示 node.content\n    const content = hasPrevious && !showAfter ? node.previousState.content : node.content;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: '1px solid #e5e7eb',\n        borderRadius: '8px',\n        padding: '16px',\n        marginBottom: '16px',\n        position: 'relative' // 为了放置右上角的 toggle\n      },\n      children: [hasPrevious && /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => setShowAfter(prev => !prev),\n        style: {\n          position: 'absolute',\n          top: '12px',\n          right: '16px',\n          padding: '4px 8px',\n          borderRadius: '9999px',\n          border: 'none',\n          cursor: 'pointer',\n          backgroundColor: '#E5E7EB',\n          fontSize: '0.75rem',\n          fontWeight: '500'\n        },\n        children: showAfter ? 'Check original hypothesis' : 'Check modified hypothesis'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1065,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          fontSize: '1.25rem',\n          fontWeight: '700',\n          marginBottom: '1rem'\n        },\n        children: node.title || 'Untitled'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1084,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '0.95rem',\n          lineHeight: '1.5',\n          color: '#374151'\n        },\n        children: content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1095,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1054,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ============== 段落9.1：HypothesisFactorsAndScoresCard（完整函数） ==============\n  const HypothesisFactorsAndScoresCard = ({\n    node,\n    isEvaluating,\n    showAfter\n  }) => {\n    // 新 color scheme\n    const noveltyColor = '#618685';\n    const feasibilityColor = '#50394c';\n    const impactColor = '#4040a1';\n    const hasBefore = !!node.previousState;\n    if (isEvaluating) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '16px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '0.875rem',\n            color: '#6b7280'\n          },\n          children: \"Scores will be displayed once evaluation is complete.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1120,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1119,\n        columnNumber: 7\n      }, this);\n    }\n\n    // 根据 showAfter 判断当前显示的 score / reason\n    const noveltyScore = showAfter || !hasBefore ? node.noveltyScore : node.previousState.noveltyScore;\n    const feasibilityScore = showAfter || !hasBefore ? node.feasibilityScore : node.previousState.feasibilityScore;\n    const impactScore = showAfter || !hasBefore ? node.impactScore : node.previousState.impactScore;\n    const noveltyReason = showAfter || !hasBefore ? node.noveltyReason : node.previousState.noveltyReason;\n    const feasibilityReason = showAfter || !hasBefore ? node.feasibilityReason : node.previousState.feasibilityReason;\n    const impactReason = showAfter || !hasBefore ? node.impactReason : node.previousState.impactReason;\n\n    // 去掉外层卡片，直接渲染三个要素\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(FactorBlock, {\n        label: \"Novelty\",\n        color: noveltyColor,\n        score: noveltyScore,\n        reason: noveltyReason,\n        beforeVal: hasBefore ? node.previousState.noveltyScore : null,\n        afterVal: node.noveltyScore,\n        showAfter: showAfter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1140,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(FactorBlock, {\n        label: \"Feasibility\",\n        color: feasibilityColor,\n        score: feasibilityScore,\n        reason: feasibilityReason,\n        beforeVal: hasBefore ? node.previousState.feasibilityScore : null,\n        afterVal: node.feasibilityScore,\n        showAfter: showAfter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1151,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(FactorBlock, {\n        label: \"Impact\",\n        color: impactColor,\n        score: impactScore,\n        reason: impactReason,\n        beforeVal: hasBefore ? node.previousState.impactScore : null,\n        afterVal: node.impactScore,\n        showAfter: showAfter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1162,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true);\n  };\n  const FactorBlock = ({\n    label,\n    color,\n    score,\n    reason,\n    beforeVal,\n    afterVal,\n    showAfter\n  }) => {\n    const getArrowDiv = (beforeVal, afterVal) => {\n      const b = parseFloat(beforeVal);\n      const a = parseFloat(afterVal);\n      if (isNaN(b) || isNaN(a)) return null;\n      if (a > b) {\n        // green arrow\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"17\",\n          height: \"17\",\n          viewBox: \"0 0 17 17\",\n          fill: \"none\",\n          xmlns: \"http://www.w3.org/2000/svg\",\n          style: {\n            margin: '0 6px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"g\", {\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M7.01221 4.32837L13.0122 4.32837L13.0122 10.3284\",\n              stroke: \"#37A219\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1193,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M4.52682 12.8137L13.0121 4.32845\",\n              stroke: \"#37A219\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1200,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1192,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1184,\n          columnNumber: 9\n        }, this);\n      } else if (a < b) {\n        // red arrow\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"17\",\n          height: \"17\",\n          viewBox: \"0 0 17 17\",\n          fill: \"none\",\n          xmlns: \"http://www.w3.org/2000/svg\",\n          style: {\n            margin: '0 6px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"g\", {\n            children: [/*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M12.9168 7.19702V13.197H6.91684\",\n              stroke: \"#A21919\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1222,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M4.43146 4.71167L12.9167 13.1969\",\n              stroke: \"#A21919\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1229,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1221,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1213,\n          columnNumber: 9\n        }, this);\n      } else {\n        // 相同 -> 横线\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"16\",\n          height: \"17\",\n          viewBox: \"0 0 16 17\",\n          fill: \"none\",\n          xmlns: \"http://www.w3.org/2000/svg\",\n          style: {\n            margin: '0 6px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"g\", {\n            id: \"Frame\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              id: \"Vector\",\n              d: \"M2.97964 8.17383L13.0204 8.17383\",\n              stroke: \"#A2A2A2\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1251,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1250,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1242,\n          columnNumber: 9\n        }, this);\n      }\n    };\n    const hasBefore = beforeVal !== null;\n    let scoreDisplay;\n    if (hasBefore) {\n      scoreDisplay = /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          fontSize: '1rem',\n          color: '#374151'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: beforeVal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1270,\n          columnNumber: 9\n        }, this), getArrowDiv(beforeVal, afterVal), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: afterVal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1272,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1269,\n        columnNumber: 7\n      }, this);\n    } else {\n      scoreDisplay = /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '1rem',\n          color: '#374151'\n        },\n        children: [\"Score: \", score]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1277,\n        columnNumber: 7\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#F9FAFB',\n        border: '1px solid #E5E7EB',\n        borderRadius: '8px',\n        padding: '16px',\n        marginBottom: '16px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          marginBottom: '8px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '12px',\n            height: '12px',\n            borderRadius: '50%',\n            backgroundColor: color,\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1294,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '1rem',\n            fontWeight: '600',\n            paddingRight: '1em',\n            color\n          },\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1303,\n          columnNumber: 9\n        }, this), scoreDisplay]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1293,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '0.875rem',\n          color: '#111827',\n          lineHeight: '1.4',\n          marginBottom: '12px',\n          whiteSpace: 'pre-wrap'\n        },\n        children: reason || '(No reason provided)'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1305,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1284,\n      columnNumber: 5\n    }, this);\n  };\n  const Dashboard = ({\n    node,\n    isEvaluating,\n    showTree\n  }) => {\n    _s();\n    // 新增 state 用于统一控制\"After/Before\"\n    const [showAfter, setShowAfter] = useState(true);\n    if (!node) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '24px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '160px',\n          color: '#9ca3af'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Click on a node to view details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1336,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1326,\n        columnNumber: 7\n      }, this);\n    }\n\n    // 仅在 node 被修改过时，才显示 toggle\n    // const hasPrevious = !!node.previousState;\n\n    return (\n      /*#__PURE__*/\n      // 整个 dashboard\n      _jsxDEV(\"div\", {\n        style: {\n          border: '1px solid #E5E7EB',\n          borderRadius: '8px',\n          backgroundColor: '#FFFFFF',\n          padding: '16px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(HypothesisCard, {\n          node: node,\n          showAfter: showAfter,\n          setShowAfter: setShowAfter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1373,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(HypothesisFactorsAndScoresCard, {\n          node: node,\n          isEvaluating: isEvaluating,\n          showAfter: showAfter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1376,\n          columnNumber: 7\n        }, this), showTree ?\n        /*#__PURE__*/\n        // Exploration View 下方替换成：Add context + Generate\n        _jsxDEV(ContextAndGenerateCard, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1384,\n          columnNumber: 9\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1346,\n        columnNumber: 5\n      }, this)\n    );\n  };\n\n  // ============== 段落10：其余子组件 ==============\n  // const IVDVCard = ({ node }) => {\n  //   const [isAfterIVDV, setIsAfterIVDV] = useState(true);\n\n  //   const SwitchButton = () => (\n  //     <div\n  //       onClick={() => setIsAfterIVDV((prev) => !prev)}\n  //       style={{\n  //         position: 'absolute',\n  //         top: '12px',\n  //         right: '12px',\n  //         cursor: 'pointer',\n  //       }}\n  //     >\n  //       <div\n  //         style={{\n  //           width: '100%',\n  //           height: '100%',\n  //           background: '#EEEEEE',\n  //           borderRadius: 62,\n  //           overflow: 'hidden',\n  //           justifyContent: 'flex-start',\n  //           alignItems: 'center',\n  //           display: 'inline-flex',\n  //         }}\n  //       >\n  //         <div\n  //           style={{\n  //             width: 42,\n  //             height: 17,\n  //             background: isAfterIVDV ? '#2E2E2E' : '#EEEEEE',\n  //             borderRadius: 62,\n  //             overflow: 'hidden',\n  //             justifyContent: 'center',\n  //             alignItems: 'center',\n  //             display: 'flex',\n  //             transition: 'all 0.2s ease',\n  //           }}\n  //         >\n  //           <div\n  //             style={{\n  //               color: isAfterIVDV ? '#EEEEEE' : '#2E2E2E',\n  //               fontSize: 10,\n  //               fontFamily: 'Inter',\n  //               fontWeight: 500,\n  //               wordWrap: 'break-word',\n  //             }}\n  //           >\n  //             After\n  //           </div>\n  //         </div>\n  //         <div\n  //           style={{\n  //             width: 40,\n  //             height: 20,\n  //             background: isAfterIVDV ? '#EEEEEE' : '#2E2E2E',\n  //             borderRadius: 62,\n  //             overflow: 'hidden',\n  //             justifyContent: 'center',\n  //             alignItems: 'center',\n  //             display: 'flex',\n  //             transition: 'all 0.2s ease',\n  //           }}\n  //         >\n  //           <div\n  //             style={{\n  //               color: isAfterIVDV ? '#2E2E2E' : '#EEEEEE',\n  //               fontSize: 10,\n  //               fontFamily: 'Inter',\n  //               fontWeight: 500,\n  //               wordWrap: 'break-word',\n  //             }}\n  //           >\n  //             Before\n  //           </div>\n  //         </div>\n  //       </div>\n  //     </div>\n  //   );\n\n  //   return (\n  //     <div\n  //       style={{\n  //         position: 'relative',\n  //         border: '1px solid #e5e7eb',\n  //         borderRadius: '8px',\n  //         backgroundColor: '#FAFAFA',\n  //         padding: '16px',\n  //         marginBottom: '16px',\n  //       }}\n  //     >\n  //       {/* <SwitchButton /> */}\n\n  //       {/* Relationship */}\n  //       <div\n  //         style={{\n  //           backgroundColor: '#F9FAFB',\n  //           padding: '12px',\n  //           borderRadius: '6px',\n  //         }}\n  //       >\n  //         <div\n  //           style={{\n  //             marginTop: '4px',\n  //             color: '#374151',\n  //             fontSize: '0.875rem',\n  //             lineHeight: '1.5',\n  //             whiteSpace: 'pre-wrap',\n  //           }}\n  //         >\n  //           {node.content}\n  //         </div>\n  //       </div>\n  //     </div>\n  //   );\n  // };\n  _s(Dashboard, \"+eSlki0jRvTkPsBUG1DiDZfpNJg=\");\n  const handleAddCustomHypothesis = async e => {\n    e.preventDefault();\n    if (!customHypothesis.title.trim() || !customHypothesis.content.trim()) return;\n    setIsGenerating(true);\n    setError(null);\n    try {\n      const newId = generateUniqueId();\n      const newHypothesis = {\n        id: newId,\n        ...customHypothesis\n      };\n\n      // 添加到假设列表\n      const updatedHypothesesList = [...hypothesesList, newHypothesis];\n      setHypothesesList(updatedHypothesesList);\n\n      // 创建新节点\n      const newNode = {\n        id: newId,\n        level: selectedNode ? selectedNode.level + 1 : 1,\n        title: customHypothesis.title.trim(),\n        content: customHypothesis.content.trim(),\n        type: 'complex',\n        x: selectedNode ? selectedNode.x + Math.random() * 20 - 10 : 0,\n        y: selectedNode ? selectedNode.y + 150 + Math.random() * 20 - 10 : 150\n      };\n\n      // 添加节点和连接\n      setNodes(prev => [...prev, newNode]);\n      if (selectedNode) {\n        setLinks(prev => [...prev, {\n          source: selectedNode.id,\n          target: newId\n        }]);\n      }\n\n      // 评估新假设\n      await evaluateHypotheses(updatedHypothesesList);\n\n      // 重置表单\n      setCustomHypothesis({\n        title: '',\n        content: ''\n      });\n      setIsAddingCustom(false);\n    } catch (err) {\n      console.error('Error adding custom hypothesis:', err);\n      setError(err.message);\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n  const ContextAndGenerateCard = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: '1px solid #e5e7eb',\n        borderRadius: '8px',\n        backgroundColor: '#FAFAFA',\n        padding: '16px',\n        marginBottom: '16px'\n      },\n      children: !isAddingCustom ? /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '8px',\n            fontSize: '0.875rem',\n            color: '#6b7280'\n          },\n          children: \"Add context for new hypotheses (optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1569,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: 2,\n          value: userInput,\n          onChange: e => setUserInput(e.target.value),\n          onClick: e => e.stopPropagation(),\n          style: {\n            width: '100%',\n            fontSize: '0.875rem',\n            padding: '8px',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            resize: 'none',\n            marginBottom: '10px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1572,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: e => {\n              e.stopPropagation();\n              generateChildNodes();\n            },\n            disabled: !selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted,\n            style: {\n              padding: '8px 16px',\n              backgroundColor: '#4C84FF',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              fontSize: '0.875rem',\n              cursor: !selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted ? 'not-allowed' : 'pointer',\n              opacity: !selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted ? 0.6 : 1\n            },\n            children: \"Generate New Hypotheses\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1589,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: e => {\n              e.stopPropagation();\n              setIsAddingCustom(true);\n            },\n            style: {\n              padding: '8px 16px',\n              backgroundColor: '#fff',\n              color: '#4C84FF',\n              border: '1px solid #4C84FF',\n              borderRadius: '4px',\n              fontSize: '0.875rem',\n              cursor: 'pointer'\n            },\n            children: \"Add Custom Hypothesis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1608,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1588,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1568,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: e => {\n          e.stopPropagation();\n          handleAddCustomHypothesis(e);\n        },\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              marginBottom: '4px',\n              fontSize: '0.875rem',\n              color: '#374151'\n            },\n            children: \"Title (2-3 words)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1636,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: customHypothesis.title,\n            onChange: e => setCustomHypothesis(prev => ({\n              ...prev,\n              title: e.target.value\n            })),\n            onClick: e => e.stopPropagation(),\n            style: {\n              width: '100%',\n              padding: '8px',\n              border: '1px solid #d1d5db',\n              borderRadius: '4px',\n              fontSize: '0.875rem'\n            },\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1639,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1635,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              marginBottom: '4px',\n              fontSize: '0.875rem',\n              color: '#374151'\n            },\n            children: \"Hypothesis Content\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1656,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: customHypothesis.content,\n            onChange: e => setCustomHypothesis(prev => ({\n              ...prev,\n              content: e.target.value\n            })),\n            onClick: e => e.stopPropagation(),\n            rows: 4,\n            style: {\n              width: '100%',\n              padding: '8px',\n              border: '1px solid #d1d5db',\n              borderRadius: '4px',\n              fontSize: '0.875rem',\n              resize: 'vertical'\n            },\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1659,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1655,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: isGenerating || isEvaluating,\n            onClick: e => e.stopPropagation(),\n            style: {\n              padding: '8px 16px',\n              backgroundColor: '#4C84FF',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              fontSize: '0.875rem',\n              cursor: isGenerating || isEvaluating ? 'not-allowed' : 'pointer',\n              opacity: isGenerating || isEvaluating ? 0.6 : 1\n            },\n            children: \"Add Hypothesis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1677,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: e => {\n              e.stopPropagation();\n              setIsAddingCustom(false);\n              setCustomHypothesis({\n                title: '',\n                content: ''\n              });\n            },\n            style: {\n              padding: '8px 16px',\n              backgroundColor: '#fff',\n              color: '#374151',\n              border: '1px solid #d1d5db',\n              borderRadius: '4px',\n              fontSize: '0.875rem',\n              cursor: 'pointer'\n            },\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1694,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1676,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1628,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1558,\n      columnNumber: 7\n    }, this);\n  };\n\n  // ============== 段落11：整体布局，渲染主界面 JSX ==============\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      fontFamily: 'Arial, sans-serif',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(TopNav, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1723,\n      columnNumber: 7\n    }, this), showTree && !isAnalysisSubmitted && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#1f2937',\n        display: 'flex',\n        alignItems: 'center',\n        padding: '10px 20px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleAnalysisIntentSubmit,\n        style: {\n          display: 'flex',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: analysisIntent,\n          onChange: e => setAnalysisIntent(e.target.value),\n          placeholder: \"Enter analysis intent\",\n          style: {\n            padding: '6px 10px',\n            borderRadius: '4px',\n            border: '1px solid #d1d5db',\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1728,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: isGenerating || isEvaluating,\n          style: {\n            padding: '6px 12px',\n            backgroundColor: '#4C84FF',\n            color: 'white',\n            border: 'none',\n            borderRadius: '4px',\n            cursor: isGenerating || isEvaluating ? 'not-allowed' : 'pointer',\n            opacity: isGenerating || isEvaluating ? 0.7 : 1\n          },\n          children: isEvaluating ? 'Evaluating...' : isGenerating ? 'Generating...' : 'Submit'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1735,\n          columnNumber: 13\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: '16px',\n            color: '#dc2626',\n            fontSize: '0.875rem'\n          },\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1750,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1727,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1726,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        padding: '20px',\n        maxWidth: '1600px',\n        margin: '0 auto',\n        boxSizing: 'border-box'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flexBasis: '60%',\n          marginRight: '20px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          ref: svgRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1758,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1757,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flexBasis: '40%'\n        },\n        children: /*#__PURE__*/_jsxDEV(Dashboard, {\n          node: nodes.find(n => n.id === ((hoveredNode === null || hoveredNode === void 0 ? void 0 : hoveredNode.id) || (selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.id))),\n          isEvaluating: isEvaluating,\n          showTree: showTree\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1768,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1762,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1755,\n      columnNumber: 7\n    }, this), pendingChange && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        left: pendingChange.screenX,\n        top: pendingChange.screenY,\n        backgroundColor: '#f3f4f6',\n        border: '1px solid #d1d5db',\n        borderRadius: '4px',\n        padding: '6px 8px',\n        zIndex: 999\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '4px',\n          fontSize: '0.875rem',\n          color: '#374151'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Confirm change?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1787,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1786,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        style: {\n          padding: '4px 8px',\n          backgroundColor: '#4C84FF',\n          color: 'white',\n          border: 'none',\n          borderRadius: '4px',\n          marginRight: '8px',\n          cursor: 'pointer'\n        },\n        onClick: () => {\n          modifyHypothesisBasedOnModifications(pendingChange.originalNode, pendingChange.ghostNode, pendingChange.modifications, pendingChange.behindNode);\n          setPendingChange(null);\n        },\n        children: \"Confirm\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1789,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        style: {\n          padding: '4px 8px',\n          backgroundColor: '#fff',\n          color: '#374151',\n          border: '1px solid #d1d5db',\n          borderRadius: '4px',\n          cursor: 'pointer'\n        },\n        onClick: () => {\n          setNodes(prev => prev.filter(nd => nd.id !== pendingChange.ghostNode.id));\n          setLinks(prev => prev.filter(lk => lk.target !== pendingChange.ghostNode.id));\n          setPendingChange(null);\n        },\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1812,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1774,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1722,\n    columnNumber: 5\n  }, this);\n};\n\n// ============== 段落13：默认导出 ==============\n_s2(TreePlotVisualization, \"SPOBzYHjQV5VoKg4kvm02tXoOJA=\");\n_c = TreePlotVisualization;\nexport default TreePlotVisualization;\nvar _c;\n$RefreshReg$(_c, \"TreePlotVisualization\");","map":{"version":3,"names":["React","useState","useEffect","useRef","d3","data_summary","jsxDEV","_jsxDEV","Fragment","_Fragment","TreePlotVisualization","_s2","_s","$RefreshSig$","showTree","setShowTree","nodes","setNodes","links","setLinks","hoveredNode","setHoveredNode","selectedNode","setSelectedNode","userInput","setUserInput","analysisIntent","setAnalysisIntent","isAnalysisSubmitted","setIsAnalysisSubmitted","isGenerating","setIsGenerating","isEvaluating","setIsEvaluating","error","setError","svgRef","hypothesesList","setHypothesesList","pendingChange","setPendingChange","isAddingCustom","setIsAddingCustom","customHypothesis","setCustomHypothesis","title","content","xAxisMetric","setXAxisMetric","yAxisMetric","setYAxisMetric","idCounterRef","generateUniqueId","current","colorMap","root","simple","complex","evaluateHypotheses","hypotheses","prompt","JSON","stringify","apiKey","process","env","REACT_APP_OPENAI_API_KEY","response","fetch","method","headers","Authorization","body","model","messages","role","max_tokens","ok","errorData","json","Error","message","data","assistantReply","choices","trim","evaluatedHypotheses","jsonMatch","match","parse","parseError","length","rankToScore","rank","total","maxScore","minScore","scoreRange","score","Math","round","prevNodes","map","node","evalHypo","find","h","id","totalHypotheses","noveltyScore","novelty_rank","feasibilityScore","feasibility_rank","impactScore","impact_rank","noveltyReason","novelty_rank_reason","feasibilityReason","feasibility_rank_reason","impactReason","impact_rank_reason","err","console","handleAnalysisIntentSubmit","e","preventDefault","hypothesesArray","slice","hypothesesWithId","hyp","updatedHypothesesList","rootNode","level","type","x","y","childSpacing","totalWidth","startX","childNodes","i","newNodes","newLinks","nd","source","target","generateChildNodes","newHypothesesWithId","random","prev","modifyHypothesisBasedOnModifications","originalNode","ghostNode","modifications","behindNode","instructionLines","behindNodeContent","forEach","mod","metricName","metric","direction","line","toLowerCase","push","instructionsText","idx","join","log","isModified","previousState","isGhost","newHypothesis","prevList","n","handleNodeClick","handleNodeHover","event","d","select","currentTarget","raise","handleNodeLeave","width","height","selectAll","remove","svg","attr","append","style","g","link","nodeGroups","enter","text","isNewlyGenerated","on","legendG","axisFO","html","xSelectElem","document","getElementById","ySelectElem","value","onchange","margin","top","right","bottom","left","chartWidth","chartHeight","xScale","scaleLinear","domain","range","yScale","xAxis","axisBottom","tickValues","tickFormat","format","yAxis","axisLeft","xGrid","tickSize","yGrid","xGridG","call","yGridG","legendEval","filteredNodes","filter","undefined","evaluationLinks","sourceNode","targetNode","drag","xx","yy","pointer","_lastX","_lastY","finalX","finalY","newXMetricValue","invert","newYMetricValue","oldXMetricValue","oldYMetricValue","deltaX","deltaY","behindNodeCandidate","abs","smallerCandidates","sort","a","b","smallerY","ghostNodeId","screenX","sourceEvent","clientX","screenY","clientY","TopNav","explorationIcon","viewBox","fill","xmlns","marginRight","children","clipPath","stroke","strokeWidth","strokeLinejoin","fileName","_jsxFileName","lineNumber","columnNumber","strokeLinecap","transform","evaluationIcon","fillRule","clipRule","tabStyle","display","alignItems","padding","cursor","borderRadius","transition","fontSize","fontWeight","explorationActiveStyle","backgroundColor","color","evaluationActiveStyle","onClick","HypothesisCard","showAfter","setShowAfter","hasPrevious","border","marginBottom","position","lineHeight","HypothesisFactorsAndScoresCard","noveltyColor","feasibilityColor","impactColor","hasBefore","FactorBlock","label","reason","beforeVal","afterVal","getArrowDiv","parseFloat","isNaN","scoreDisplay","paddingRight","whiteSpace","Dashboard","justifyContent","ContextAndGenerateCard","handleAddCustomHypothesis","newId","newNode","stopPropagation","rows","onChange","resize","gap","disabled","opacity","onSubmit","required","fontFamily","placeholder","marginLeft","maxWidth","boxSizing","flexBasis","ref","zIndex","lk","_c","$RefreshReg$"],"sources":["/Users/jasonding/Desktop/RAG-example/src/components/TreePlotVisualization.jsx"],"sourcesContent":["// ============== 段落1：导入依赖 ==============\nimport React, { useState, useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport data_summary from './data_summary.json'; // 确保有 data_summary.json\n\n// ============== 段落2：定义 TreePlotVisualization 组件 ==============\nconst TreePlotVisualization = () => {\n  // ============== 段落2.1：定义所有 state 变量 ==============\n  const [showTree, setShowTree] = useState(true); // true: Exploration View, false: Evaluation View\n  const [nodes, setNodes] = useState([]);\n  const [links, setLinks] = useState([]);\n  const [hoveredNode, setHoveredNode] = useState(null);\n  const [selectedNode, setSelectedNode] = useState(null);\n  const [userInput, setUserInput] = useState('');\n  const [analysisIntent, setAnalysisIntent] = useState('');\n  const [isAnalysisSubmitted, setIsAnalysisSubmitted] = useState(false);\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [isEvaluating, setIsEvaluating] = useState(false);\n  const [error, setError] = useState(null);\n  const svgRef = useRef(null);\n  const [hypothesesList, setHypothesesList] = useState([]);\n  // **新增**: 用于存放\"拖拽后生成的 ghostNode + 悬浮确认按钮信息\"\n  const [pendingChange, setPendingChange] = useState(null);\n  const [isAddingCustom, setIsAddingCustom] = useState(false);\n  const [customHypothesis, setCustomHypothesis] = useState({ title: '', content: '' });\n\n  // X/Y 轴指标（仅在 Evaluation View 用）\n  const [xAxisMetric, setXAxisMetric] = useState('feasibilityScore');\n  const [yAxisMetric, setYAxisMetric] = useState('noveltyScore');\n\n  // ID 计数器\n  const idCounterRef = useRef(0);\n  const generateUniqueId = () => {\n    idCounterRef.current += 1;\n    return `node-${idCounterRef.current}`;\n  };\n\n  // 配色映射\n  const colorMap = {\n    root: '#4C84FF',\n    simple: '#45B649',\n    complex: '#FF6B6B',\n  };\n\n  // ============== 段落3：评估假设（evaluateHypotheses） ==============\n  const evaluateHypotheses = async (hypotheses) => {\n    setIsEvaluating(true);\n    setError(null);\n\n    try {\n      const prompt = `For the following hypotheses, rank **each one individually** based on novelty, feasibility, and impact.\n      Novelty is judged by whether the hypotheses challenges traditional assumptions, propose innovative approaches, or explore under-researched areas will score higher in novelty. Less novel hypotheses include those that replicate well-known findings or extend existing studies with minimal new insights.\n      Feasibility is judged by whether the hypothesis can be represented by the dataset described in the data summary.\n      Impact assesses how the hypotheses addresses critical or emerging issues, influence policy or decision-making, or provide insights into major societal, economic, or scientific challenges. Hypotheses with lower impact are narrower in scope or contribute incremental knowledge without broader implications.\n      For each hypothesis, provide its rank (1 being the highest) in terms of novelty, feasibility, and impact.\n      Also, provide the ranking reasons for each hypothesis.\n      **Ensure that you include all hypotheses in your evaluation and do not combine or omit any.**\n      **No two hypotheses should have the same rank in any category. Assign unique ranks to each hypothesis in each category to avoid overlaps.**\n      Return the results in JSON format as an array of objects with the following fields:\n      - id\n      - novelty_rank\n      - novelty_rank_reason\n      - feasibility_rank\n      - feasibility_rank_reason\n      - impact_rank\n      - impact_rank_reason\n\nHere are the hypotheses:\n${JSON.stringify(hypotheses)}\n\nData summary: ${JSON.stringify(data_summary)}\n\nPlease provide only the JSON array in your response.`;\n\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`,\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [\n            { role: 'system', content: 'You are a data scientist.' },\n            { role: 'user', content: prompt },\n          ],\n          max_tokens: 2000,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n\n      let evaluatedHypotheses;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          evaluatedHypotheses = JSON.parse(jsonMatch[0]);\n        } else {\n          evaluatedHypotheses = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse evaluated hypotheses JSON from the assistant's reply.\");\n      }\n\n      if (evaluatedHypotheses.length !== hypotheses.length) {\n        throw new Error(\n          `Mismatch in number of evaluated hypotheses. Expected ${hypotheses.length}, but got ${evaluatedHypotheses.length}.`\n        );\n      }\n\n      // rank -> score\n      const rankToScore = (rank, total) => {\n        const maxScore = 90;\n        const minScore = 10;\n        const scoreRange = maxScore - minScore;\n        // 分数从高到低\n        const score = maxScore - ((rank - 1) * scoreRange) / (total - 1);\n        return Math.round(score);\n      };\n\n      setNodes((prevNodes) =>\n        prevNodes.map((node) => {\n          const evalHypo = evaluatedHypotheses.find((h) => h.id === node.id);\n          if (evalHypo) {\n            const totalHypotheses = hypotheses.length;\n            const noveltyScore = rankToScore(evalHypo.novelty_rank, totalHypotheses);\n            const feasibilityScore = rankToScore(evalHypo.feasibility_rank, totalHypotheses);\n            const impactScore = rankToScore(evalHypo.impact_rank, totalHypotheses);\n\n            return {\n              ...node,\n              noveltyScore,\n              feasibilityScore,\n              impactScore,\n              noveltyReason: evalHypo.novelty_rank_reason || '(No reason provided)',\n              feasibilityReason: evalHypo.feasibility_rank_reason || '(No reason provided)',\n              impactReason: evalHypo.impact_rank_reason || '(No reason provided)',\n            };\n          }\n          return node;\n        })\n      );\n    } catch (err) {\n      console.error('Error evaluating hypotheses:', err);\n      setError(err.message);\n    } finally {\n      setIsEvaluating(false);\n    }\n  };\n\n  // ============== 段落4：分析意图提交处理 (handleAnalysisIntentSubmit) ==============\n  const handleAnalysisIntentSubmit = async (e) => {\n    e.preventDefault();\n    if (!analysisIntent.trim()) return;\n\n    setIsGenerating(true);\n    setError(null);\n\n    try {\n      const prompt = `Based on the following analysis intent and data, generate exactly three initial hypotheses. For each hypothesis, provide a two-word title and a detailed content. Return the hypotheses in JSON format as an array of objects with \"title\" and \"content\" fields.\n\nAnalysis Intent: ${analysisIntent}\n\nData: ${JSON.stringify(data_summary)}\n\nPlease provide only the JSON array in your response.`;\n\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`,\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [\n            { role: 'system', content: 'You are a data scientist.' },\n            { role: 'user', content: prompt },\n          ],\n          max_tokens: 500,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n\n      let hypothesesArray;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          hypothesesArray = JSON.parse(jsonMatch[0]);\n        } else {\n          hypothesesArray = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse hypotheses JSON from the assistant's reply.\");\n      }\n\n      const hypotheses = hypothesesArray.slice(0, 3);\n      const hypothesesWithId = hypotheses.map((hyp) => {\n        const id = generateUniqueId();\n        return { id, ...hyp };\n      });\n\n      const updatedHypothesesList = [...hypothesesList, ...hypothesesWithId];\n      setHypothesesList(updatedHypothesesList);\n\n      // Root node\n      const rootNode = {\n        id: 'root',\n        level: 0,\n        title: analysisIntent,\n        content: analysisIntent,\n        type: 'root',\n        x: 0,\n        y: 0,\n      };\n\n      // Child nodes\n      const childSpacing = 200;\n      const totalWidth = (hypotheses.length - 1) * childSpacing;\n      const startX = rootNode.x - totalWidth / 2;\n\n      const childNodes = hypothesesWithId.map((hyp, i) => ({\n        id: hyp.id,\n        level: 1,\n        title: hyp.title.trim(),\n        content: hyp.content.trim(),\n        type: 'complex',\n        x: startX + i * childSpacing,\n        y: rootNode.y + 150,\n      }));\n\n      const newNodes = [rootNode, ...childNodes];\n      const newLinks = childNodes.map((nd) => ({ source: rootNode.id, target: nd.id }));\n      setNodes(newNodes);\n      setLinks(newLinks);\n\n      setAnalysisIntent('');\n      setIsAnalysisSubmitted(true);\n\n      // 评估\n      await evaluateHypotheses(updatedHypothesesList);\n      setIsGenerating(false);\n    } catch (err) {\n      console.error('Error generating initial hypotheses:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    }\n  };\n\n  // ============== 段落5：生成子节点 (generateChildNodes) ==============\n  const generateChildNodes = async () => {\n    if (!selectedNode) return;\n    setIsGenerating(true);\n    setError(null);\n\n    try {\n      const prompt = `Based on the following node content and data, generate exactly three new hypotheses. For each hypothesis, provide a two-word title and a detailed content. Return the hypotheses in JSON format as an array of objects with \"title\" and \"content\" fields.\n\nNode Content: ${selectedNode.content}\n\nData: ${JSON.stringify(data_summary)}\n\nAdditional Context: ${userInput}\n\nPlease provide only the JSON array in your response.`;\n\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`,\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [\n            { role: 'system', content: 'You are a data scientist.' },\n            { role: 'user', content: prompt },\n          ],\n          max_tokens: 500,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n\n      let hypothesesArray;\n      try {\n        const jsonMatch = assistantReply.match(/\\[.*\\]/s);\n        if (jsonMatch) {\n          hypothesesArray = JSON.parse(jsonMatch[0]);\n        } else {\n          hypothesesArray = JSON.parse(assistantReply);\n        }\n      } catch (parseError) {\n        throw new Error(\"Failed to parse hypotheses JSON from the assistant's reply.\");\n      }\n\n      const hypotheses = hypothesesArray.slice(0, 3);\n      const newHypothesesWithId = hypotheses.map((hyp) => {\n        const id = generateUniqueId();\n        return { id, ...hyp };\n      });\n\n      const updatedHypothesesList = [...hypothesesList, ...newHypothesesWithId];\n      setHypothesesList(updatedHypothesesList);\n\n      // 布局\n      const childSpacing = 200;\n      const totalWidth = (hypotheses.length - 1) * childSpacing;\n      const startX = selectedNode.x - totalWidth / 2;\n\n      const newNodes = newHypothesesWithId.map((hyp, i) => ({\n        id: hyp.id,\n        level: selectedNode.level + 1,\n        title: hyp.title.trim(),\n        content: hyp.content.trim(),\n        type: 'complex',\n        x: startX + i * childSpacing + Math.random() * 20 - 10,\n        y: selectedNode.y + 150 + Math.random() * 20 - 10,\n      }));\n\n      const newLinks = newNodes.map((nd) => ({ source: selectedNode.id, target: nd.id }));\n      setNodes((prev) => [...prev, ...newNodes]);\n      setLinks((prev) => [...prev, ...newLinks]);\n\n      // 评估\n      await evaluateHypotheses(updatedHypothesesList);\n\n      setIsGenerating(false);\n      setUserInput('');\n    } catch (err) {\n      console.error('Error generating hypotheses:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    }\n  };\n\n  // ============== 段落6：根据拖拽修改假设 (modifyHypothesisBasedOnModifications) ==============\n  // ============== 段落6：修改开始 ==============\n  const modifyHypothesisBasedOnModifications = async (\n    originalNode,\n    ghostNode,\n    modifications,\n    behindNode\n  ) => {\n    setError(null);\n\n    try {\n      setIsGenerating(true);\n\n      // 根据每个指标和对应的 increase/decrease，拼接更灵活的描述\n      let instructionLines = [];\n      const behindNodeContent = behindNode ? behindNode.content : '(No behind node found)';\n\n      modifications.forEach((mod) => {\n        const metricName =\n          mod.metric === 'noveltyScore'\n            ? 'Novelty'\n            : mod.metric === 'feasibilityScore'\n            ? 'Feasibility'\n            : 'Impact';\n        const direction = mod.direction === 'increase' ? 'increasing' : 'decreasing';\n        const line = `by ${direction} its ${metricName} with ${\n          direction === 'increasing' ? 'more' : 'less'\n        } ${metricName.toLowerCase()} than this hypothesis:\\n${behindNodeContent}`;\n        instructionLines.push(line);\n      });\n\n      const instructionsText = instructionLines\n        .map((line, idx) => {\n          if (idx === 0) return `Modify this hypothesis ${line}`;\n          return `And ${line}`;\n        })\n        .join('\\n\\n');\n\n      const prompt = `\n  ${instructionsText}\n\n  Keep its main idea intact, but focus on adjusting the degree of novelty, feasibility, and/or impact as requested.\n\n  Original hypothesis:\n  ${originalNode.content}\n\n  Dataset summary: ${JSON.stringify(data_summary)}\n\n  Please provide only the modified hypothesis content in your response.\n      `.trim();\n\n\n      console.log('modify prompt:', prompt);\n\n      const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${apiKey}`,\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [\n            { role: 'system', content: 'You are a data scientist.' },\n            { role: 'user', content: prompt },\n          ],\n          max_tokens: 500,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error.message);\n      }\n\n      const data = await response.json();\n      const assistantReply = data.choices[0].message.content.trim();\n\n      ghostNode.content = assistantReply;\n      ghostNode.isModified = true;\n      ghostNode.previousState = originalNode;\n      ghostNode.isGhost = false;\n\n      const newHypothesis = {\n        id: ghostNode.id,\n        title: ghostNode.title,\n        content: assistantReply,\n      };\n      setHypothesesList((prevList) => [...prevList, newHypothesis]);\n\n      setNodes((prevNodes) => prevNodes.map((n) => (n.id === ghostNode.id ? ghostNode : n)));\n      setIsGenerating(false);\n      setIsEvaluating(true);\n\n      await evaluateHypotheses([...hypothesesList, newHypothesis]);\n    } catch (err) {\n      console.error('Error modifying hypothesis:', err);\n      setError(err.message);\n      setIsGenerating(false);\n    } finally {\n      setIsEvaluating(false);\n    }\n  };\n  // ============== 段落6：修改结束 ==============\n\n  // ============== 段落7：节点点击/悬浮/离开事件处理 ==============\n  const handleNodeClick = (node) => {\n    setSelectedNode((prev) => (prev?.id === node.id ? null : node));\n  };\n  const handleNodeHover = (event, d) => {\n    setHoveredNode(d);\n    d3.select(event.currentTarget).raise();\n  };\n  const handleNodeLeave = () => {\n    setHoveredNode(null);\n  };\n\n  // ============== 段落8：D3 渲染逻辑 useEffect ==============\n  useEffect(() => {\n    if (!svgRef.current) return;\n\n    const width = 800;\n    const height = 600;\n\n    // 清空 SVG\n    d3.select(svgRef.current).selectAll('*').remove();\n\n    if (showTree) {\n      // ------------------- Exploration (Tree) View --------------------\n      const svg = d3.select(svgRef.current).attr('width', width).attr('height', height);\n\n      // 卡片背景\n      svg\n        .append('rect')\n        .attr('x', 2)\n        .attr('y', 2)\n        .attr('width', width - 4)\n        .attr('height', height - 4)\n        .attr('rx', 8)\n        .attr('ry', 8)\n        .style('fill', '#fff')\n        .style('stroke', '#e5e7eb')\n        .style('stroke-width', 1)\n        .style('filter', 'drop-shadow(0 4px 6px rgba(0,0,0,0.1))');\n\n      const g = svg.append('g').attr('transform', `translate(300, 130)`);\n\n      // 连线\n      links.forEach((link) => {\n        const source = nodes.find((n) => n.id === link.source);\n        const target = nodes.find((n) => n.id === link.target);\n        if (source && target) {\n          g.append('path')\n            .attr(\n              'd',\n              `M ${source.x},${source.y} C ${source.x},${(source.y + target.y) / 2} \n               ${target.x},${(source.y + target.y) / 2} \n               ${target.x},${target.y}`\n            )\n            .style('fill', 'none')\n            .style('stroke', '#ccc')\n            .style('stroke-width', 2);\n        }\n      });\n\n      // 节点\n      const nodeGroups = g\n        .selectAll('.node')\n        .data(nodes)\n        .enter()\n        .append('g')\n        .attr('class', 'node')\n        .attr('transform', (d) => `translate(${d.x},${d.y})`);\n\n      nodeGroups\n        .append('text')\n        .attr('dy', 35)\n        .attr('text-anchor', 'middle')\n        .text((d) => d.title)\n        .attr('pointer-events', 'none');\n\n      nodeGroups\n        .append('circle')\n        .attr('r', 25)\n        .style('fill', (d) => (d.isNewlyGenerated ? '#FFD700' : colorMap[d.type]))\n        .style('opacity', (d) => (d.isGhost ? 0.5 : 1))\n        .style('stroke', (d) => {\n          if (selectedNode?.id === d.id) return '#000';\n          else if (hoveredNode?.id === d.id) return '#555';\n          else return '#fff';\n        })\n        .style('stroke-width', (d) => {\n          if (selectedNode?.id === d.id) return 4;\n          else if (hoveredNode?.id === d.id) return 3;\n          else return 2;\n        })\n        .style('cursor', 'pointer')\n        .on('mouseenter', handleNodeHover)\n        .on('mouseleave', handleNodeLeave)\n        .on('click', (event, d) => handleNodeClick(d));\n\n      // 在卡片底部放三个颜色标识 (蓝/红/黄)\n      const legendG = svg.append('g').attr('transform', `translate(40, ${height - 40})`);\n      legendG\n        .append('circle')\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .attr('r', 6)\n        .style('fill', '#4C84FF');\n      legendG\n        .append('text')\n        .attr('x', 14)\n        .attr('y', 4)\n        .style('font-size', '0.875rem')\n        .style('fill', '#374151')\n        .text('Intent');\n      legendG\n        .append('circle')\n        .attr('cx', 100)\n        .attr('cy', 0)\n        .attr('r', 6)\n        .style('fill', '#FF6B6B');\n      legendG\n        .append('text')\n        .attr('x', 110)\n        .attr('y', 4)\n        .style('font-size', '0.875rem')\n        .style('fill', '#374151')\n        .text('Original Hypothesis');\n      legendG\n        .append('circle')\n        .attr('cx', 270)\n        .attr('cy', 0)\n        .attr('r', 6)\n        .style('fill', '#FFD700');\n      legendG\n        .append('text')\n        .attr('x', 284)\n        .attr('y', 4)\n        .style('font-size', '0.875rem')\n        .style('fill', '#374151')\n        .text('Modified Hypothesis');\n    } else {\n      // ------------------- Evaluation (Scatter) View --------------------\n      const svg = d3.select(svgRef.current).attr('width', width).attr('height', height);\n\n      // 背景卡片\n      svg\n        .append('rect')\n        .attr('x', 2)\n        .attr('y', 2)\n        .attr('width', width - 4)\n        .attr('height', height - 4)\n        .attr('rx', 8)\n        .attr('ry', 8)\n        .style('fill', '#fff')\n        .style('stroke', '#e5e7eb')\n        .style('stroke-width', 1)\n        .style('filter', 'drop-shadow(0 4px 6px rgba(0,0,0,0.1))');\n\n      const axisFO = svg\n        .append('foreignObject')\n        .attr('x', width - 210)\n        .attr('y', 20)\n        .attr('width', 200)\n        .attr('height', 60);\n\n      axisFO\n        .append('xhtml:div')\n        .style('display', 'flex')\n        .style('flexDirection', 'column')\n        .style('gap', '6px')\n        .style('fontSize', '0.875rem')\n        .html(`\n        <div style=\"display: flex; flex-direction: column; gap: 10px;\">\n          <div style=\"display: flex; align-items: center;\">\n            <label for=\"xSelect\" style=\"color: #374151; margin-right: 6px;\">X-Axis:</label>\n            <select id=\"xSelect\" \n              style=\"padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; color: #374151;\">\n              <option value=\"noveltyScore\">Novelty</option>\n              <option value=\"feasibilityScore\">Feasibility</option>\n              <option value=\"impactScore\">Impact</option>\n            </select>\n          </div>\n\n          <div style=\"display: flex; align-items: center;\">\n            <label for=\"ySelect\" style=\"color: #374151; margin-right: 6px;\">Y-Axis:</label>\n            <select id=\"ySelect\" \n              style=\"padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; background-color: #f9fafb; color: #374151;\">\n              <option value=\"noveltyScore\">Novelty</option>\n              <option value=\"feasibilityScore\">Feasibility</option>\n              <option value=\"impactScore\">Impact</option>\n            </select>\n          </div>\n        </div>\n      `);\n\n      const xSelectElem = document.getElementById('xSelect');\n      const ySelectElem = document.getElementById('ySelect');\n      if (xSelectElem) xSelectElem.value = xAxisMetric;\n      if (ySelectElem) ySelectElem.value = yAxisMetric;\n\n      if (xSelectElem) {\n        xSelectElem.onchange = (e) => setXAxisMetric(e.target.value);\n      }\n      if (ySelectElem) {\n        ySelectElem.onchange = (e) => setYAxisMetric(e.target.value);\n      }\n\n      const margin = { top: 100, right: 50, bottom: 80, left: 50 };\n      const chartWidth = width - margin.left - margin.right;\n      const chartHeight = height - margin.top - margin.bottom;\n\n      const g = svg.append('g').attr('transform', `translate(${margin.left}, ${margin.top})`);\n\n      const xScale = d3.scaleLinear().domain([0, 100]).range([0, chartWidth]);\n      const yScale = d3.scaleLinear().domain([0, 100]).range([chartHeight, 0]);\n\n      const xAxis = d3\n        .axisBottom(xScale)\n        .tickValues(d3.range(0, 101, 20))\n        .tickFormat(d3.format('d'));\n      const yAxis = d3\n        .axisLeft(yScale)\n        .tickValues(d3.range(0, 101, 20))\n        .tickFormat(d3.format('d'));\n\n      const xGrid = d3.axisBottom(xScale).tickValues(d3.range(0, 101, 20)).tickSize(-chartHeight).tickFormat('');\n      const yGrid = d3.axisLeft(yScale).tickValues(d3.range(0, 101, 20)).tickSize(-chartWidth).tickFormat('');\n\n      const xGridG = g.append('g').attr('class', 'x-grid').attr('transform', `translate(0, ${chartHeight})`).call(xGrid);\n      xGridG.selectAll('.domain').remove();\n      xGridG.selectAll('.tick line').style('stroke', '#F1F1F1');\n\n      const yGridG = g.append('g').attr('class', 'y-grid').call(yGrid);\n      yGridG.selectAll('.domain').remove();\n      yGridG.selectAll('.tick line').style('stroke', '#F1F1F1');\n\n      g.append('g').attr('transform', `translate(0, ${chartHeight})`).call(xAxis);\n      g.append('g').call(yAxis);\n\n      g\n        .append('text')\n        .attr('x', chartWidth / 2)\n        .attr('y', chartHeight + 40)\n        .style('text-anchor', 'middle')\n        .style('fill', '#374151')\n        .style('font-size', '1.2rem')\n        .text(\n          xAxisMetric === 'noveltyScore'\n            ? 'Novelty'\n            : xAxisMetric === 'feasibilityScore'\n            ? 'Feasibility'\n            : 'Impact'\n        );\n\n      g\n        .append('text')\n        .attr('transform', 'rotate(-90)')\n        .attr('x', -chartHeight / 2)\n        .attr('y', -30)\n        .style('text-anchor', 'middle')\n        .style('fill', '#374151')\n        .style('font-size', '1.2rem')\n        .text(\n          yAxisMetric === 'noveltyScore'\n            ? 'Novelty'\n            : yAxisMetric === 'feasibilityScore'\n            ? 'Feasibility'\n            : 'Impact'\n        );\n\n      const legendEval = svg.append('g').attr('transform', `translate(${margin.left}, ${height - 30})`);\n\n      legendEval\n        .append('circle')\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .attr('r', 5)\n        .style('fill', '#FF6B6B');\n      legendEval\n        .append('text')\n        .attr('x', 10)\n        .attr('y', 4)\n        .style('fontSize', '0.875rem')\n        .style('fill', '#374151')\n        .text('Original');\n\n      legendEval\n        .append('circle')\n        .attr('cx', 80)\n        .attr('cy', 0)\n        .attr('r', 5)\n        .style('fill', '#FFC300');\n      legendEval\n        .append('text')\n        .attr('x', 90)\n        .attr('y', 4)\n        .style('fontSize', '0.875rem')\n        .style('fill', '#374151')\n        .text('Modified');\n\n      const filteredNodes = nodes.filter((d) => d[xAxisMetric] !== undefined && d[yAxisMetric] !== undefined);\n\n      const evaluationLinks = links.filter((link) => {\n        const sourceNode = nodes.find((n) => n.id === link.source);\n        const targetNode = nodes.find((n) => n.id === link.target);\n        return sourceNode && targetNode && targetNode.isModified;\n      });\n\n      evaluationLinks.forEach((link) => {\n        const source = nodes.find((n) => n.id === link.source);\n        const target = nodes.find((n) => n.id === link.target);\n        if (source && target) {\n          g.append('line')\n            .attr('x1', xScale(source[xAxisMetric]))\n            .attr('y1', yScale(source[yAxisMetric]))\n            .attr('x2', xScale(target[xAxisMetric]))\n            .attr('y2', yScale(target[yAxisMetric]))\n            .style('stroke', '#ccc')\n            .style('stroke-width', 1);\n        }\n      });\n\n      const nodeGroups = g\n        .selectAll('.node-group')\n        .data(filteredNodes)\n        .enter()\n        .append('g')\n        .attr('class', 'node-group')\n        .attr('transform', (d) => `translate(${xScale(d[xAxisMetric])}, ${yScale(d[yAxisMetric])})`)\n        .style('cursor', 'pointer')\n        .on('mouseenter', handleNodeHover)\n        .on('mouseleave', handleNodeLeave)\n        .on('click', (event, d) => handleNodeClick(d))\n        .call(\n          d3\n            .drag()\n            .on('start', function (event, d) {\n              if (isGenerating || isEvaluating) return;\n              d3.select(this).raise();\n            })\n            .on('drag', function (event, d) {\n              if (isGenerating || isEvaluating) return;\n              const [xx, yy] = d3.pointer(event, g.node());\n              d3.select(this).attr('transform', `translate(${xx}, ${yy})`);\n              d._lastX = xx;\n              d._lastY = yy;\n            })\n            .on('end', function (event, d) {\n              if (isGenerating || isEvaluating) return;\n              let finalX = typeof d._lastX === 'number' ? d._lastX : d3.pointer(event, g.node())[0];\n              let finalY = typeof d._lastY === 'number' ? d._lastY : d3.pointer(event, g.node())[1];\n\n              const newXMetricValue = xScale.invert(finalX);\n              const newYMetricValue = yScale.invert(finalY);\n\n              const oldXMetricValue = d[xAxisMetric];\n              const oldYMetricValue = d[yAxisMetric];\n              const deltaX = newXMetricValue - oldXMetricValue;\n              const deltaY = newYMetricValue - oldYMetricValue;\n\n              delete d._lastX;\n              delete d._lastY;\n\n              let modifications = [];\n              let behindNodeCandidate = null;\n\n              if (Math.abs(deltaX) > 5) {\n                modifications.push({\n                  metric: xAxisMetric,\n                  direction: deltaX > 0 ? 'increase' : 'decrease',\n                });\n                const smallerCandidates = nodes\n                  .filter((node) => node[xAxisMetric] !== undefined && node.id !== d.id && node[xAxisMetric] < newXMetricValue)\n                  .sort((a, b) => b[xAxisMetric] - a[xAxisMetric]);\n                if (smallerCandidates[0]) {\n                  behindNodeCandidate = smallerCandidates[0];\n                }\n              }\n\n              if (Math.abs(deltaY) > 5) {\n                modifications.push({\n                  metric: yAxisMetric,\n                  direction: deltaY > 0 ? 'increase' : 'decrease',\n                });\n                const smallerY = nodes\n                  .filter((node) => node[yAxisMetric] !== undefined && node.id !== d.id && node[yAxisMetric] < newYMetricValue)\n                  .sort((a, b) => b[yAxisMetric] - a[yAxisMetric]);\n                if (smallerY[0]) {\n                  behindNodeCandidate = smallerY[0] || behindNodeCandidate;\n                }\n              }\n\n              d3.select(this).attr(\n                'transform',\n                `translate(${xScale(d[xAxisMetric])}, ${yScale(d[yAxisMetric])})`\n              );\n\n              if (modifications.length > 0) {\n                const ghostNodeId = generateUniqueId();\n                const ghostNode = {\n                  ...d,\n                  id: ghostNodeId,\n                  x: d.x,\n                  y: d.y,\n                  [xAxisMetric]: newXMetricValue,\n                  [yAxisMetric]: newYMetricValue,\n                  isGhost: true,\n                  isNewlyGenerated: true,\n                };\n\n                setNodes((prev) => [...prev, ghostNode]);\n                setLinks((prev) => [...prev, { source: d.id, target: ghostNodeId }]);\n\n                setPendingChange({\n                  originalNode: d,\n                  ghostNode,\n                  modifications,\n                  behindNode: behindNodeCandidate,\n                  screenX: event.sourceEvent.clientX + 10,\n                  screenY: event.sourceEvent.clientY + 10,\n                });\n              }\n            })\n        );\n\n      nodeGroups\n        .append('circle')\n        .attr('r', 8)\n        .style('fill', (d) => (d.isNewlyGenerated ? '#FFD700' : colorMap[d.type]))\n        .style('opacity', (d) => (d.isGhost ? 0.5 : 1))\n        .style('stroke', (d) => {\n          if (selectedNode?.id === d.id) return '#000';\n          else if (hoveredNode?.id === d.id) return '#555';\n          else return '#fff';\n        })\n        .style('stroke-width', (d) => {\n          if (selectedNode?.id === d.id) return 4;\n          else if (hoveredNode?.id === d.id) return 3;\n          else return 2;\n        });\n    }\n  }, [\n    showTree,\n    nodes,\n    links,\n    selectedNode,\n    hoveredNode,\n    xAxisMetric,\n    yAxisMetric,\n    isGenerating,\n    isEvaluating,\n  ]);\n\n  // ============== 段落9：Dashboard 相关逻辑 ==============\n  const TopNav = () => {\n    const explorationIcon = (\n      <svg\n        width=\"20\"\n        height=\"20\"\n        viewBox=\"0 0 20 20\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        style={{ marginRight: '8px' }}\n      >\n        <g clipPath=\"url(#clip0_119_560)\">\n          <path\n            d=\"M8.52543 15.8306C12.2418 15.8306 15.2546 12.8179 15.2546 9.10148C15.2546 5.38508 12.2418 2.37231 8.52543 2.37231C4.80903 2.37231 1.79626 5.38508 1.79626 9.10148C1.79626 12.8179 4.80903 15.8306 8.52543 15.8306Z\"\n            stroke=\"#A2A2A2\"\n            strokeWidth=\"2\"\n            strokeLinejoin=\"round\"\n          />\n          <path\n            d=\"M10.7646 6.46654C10.1915 5.89349 9.39988 5.53906 8.5254 5.53906C7.65097 5.53906 6.8593 5.89349 6.28625 6.46654\"\n            stroke=\"#A2A2A2\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n          <path\n            d=\"M13.3632 13.9392L16.7219 17.298\"\n            stroke=\"#A2A2A2\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n        </g>\n        <defs>\n          <clipPath id=\"clip0_119_560\">\n            <rect width=\"19\" height=\"19\" fill=\"white\" transform=\"translate(0.212891 0.789062)\" />\n          </clipPath>\n        </defs>\n      </svg>\n    );\n  \n    const evaluationIcon = (\n      <svg\n        width=\"20\"\n        height=\"20\"\n        viewBox=\"0 0 20 20\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        style={{ marginRight: '8px' }}\n      >\n        <g>\n          <path\n            d=\"M2.47949 2.46533V16.7153H16.7295\"\n            stroke=\"#141414\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M8.02114 9.59025C8.89557 9.59025 9.60447 8.88135 9.60447 8.00692C9.60447 7.13248 8.89557 6.42358 8.02114 6.42358C7.1467 6.42358 6.43781 7.13248 6.43781 8.00692C6.43781 8.88135 7.1467 9.59025 8.02114 9.59025Z\"\n            fill=\"#141414\"\n          />\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M14.7503 6.42367C15.8434 6.42367 16.7295 5.53755 16.7295 4.4445C16.7295 3.35144 15.8434 2.46533 14.7503 2.46533C13.6573 2.46533 12.7712 3.35144 12.7712 4.4445C12.7712 5.53755 13.6573 6.42367 14.7503 6.42367Z\"\n            fill=\"#141414\"\n          />\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M6.04199 14.3403C6.69785 14.3403 7.22949 13.8087 7.22949 13.1528C7.22949 12.497 6.69785 11.9653 6.04199 11.9653C5.38614 11.9653 4.85449 12.497 4.85449 13.1528C4.85449 13.8087 5.38614 14.3403 6.04199 14.3403Z\"\n            fill=\"#141414\"\n          />\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M13.167 12.7571C13.8228 12.7571 14.3545 12.2254 14.3545 11.5696C14.3545 10.9137 13.8228 10.3821 13.167 10.3821C12.5111 10.3821 11.9795 10.9137 11.9795 11.5696C11.9795 12.2254 12.5111 12.7571 13.167 12.7571Z\"\n            fill=\"#141414\"\n          />\n        </g>\n      </svg>\n    );\n  \n    const tabStyle = {\n      display: 'flex',\n      alignItems: 'center',\n      padding: '10px 16px',\n      cursor: 'pointer',\n      borderRadius: '9999px',\n      transition: 'all 0.2s ease',\n      fontSize: '0.875rem',\n      fontWeight: 500,\n    };\n  \n    const explorationActiveStyle = showTree\n      ? { backgroundColor: '#fff', color: '#141414' }\n      : { backgroundColor: 'transparent', color: '#A0AEC0' };\n  \n    const evaluationActiveStyle = !showTree\n      ? { backgroundColor: '#fff', color: '#141414' }\n      : { backgroundColor: 'transparent', color: '#A0AEC0' };\n  \n    return (\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          backgroundColor: '#0F172A',\n          padding: '10px 20px',\n        }}\n      >\n        {/* Exploration View Tab */}\n        <div style={{ ...tabStyle, ...explorationActiveStyle, marginRight: '6px' }} onClick={() => setShowTree(true)}>\n          {explorationIcon}\n          Exploration View\n        </div>\n  \n        {/* Evaluation View Tab */}\n        <div style={{ ...tabStyle, ...evaluationActiveStyle }} onClick={() => setShowTree(false)}>\n          {evaluationIcon}\n          Evaluation View\n        </div>\n      </div>\n    );\n  };\n\n  // ============== 段落9.1：新的合并卡片组件 ==============\n\n  const HypothesisCard = ({ node, showAfter, setShowAfter }) => {\n    const hasPrevious = !!node.previousState;\n    // 如果未被修改过，则直接显示 node.content\n    const content = hasPrevious && !showAfter\n      ? node.previousState.content\n      : node.content;\n  \n    return (\n      <div\n        style={{\n          border: '1px solid #e5e7eb',\n          borderRadius: '8px',\n          padding: '16px',\n          marginBottom: '16px',\n          position: 'relative', // 为了放置右上角的 toggle\n        }}\n      >\n        {/* 右上角 toggle，仅在 hasPrevious 时显示 */}\n        {hasPrevious && (\n          <div\n            onClick={() => setShowAfter((prev) => !prev)}\n            style={{\n              position: 'absolute',\n              top: '12px',\n              right: '16px',\n              padding: '4px 8px',\n              borderRadius: '9999px',\n              border: 'none',\n              cursor: 'pointer',\n              backgroundColor: '#E5E7EB',\n              fontSize: '0.75rem',\n              fontWeight: '500',\n            }}\n          >\n            {showAfter ? 'Check original hypothesis' : 'Check modified hypothesis'}\n          </div>\n        )}\n  \n        <h2\n          style={{\n            fontSize: '1.25rem',\n            fontWeight: '700',\n            marginBottom: '1rem',\n          }}\n        >\n          {node.title || 'Untitled'}\n        </h2>\n  \n        {/* Hypothesis Text */}\n        <div\n          style={{\n            fontSize: '0.95rem',\n            lineHeight: '1.5',\n            color: '#374151',\n          }}\n        >\n          {content}\n        </div>\n      </div>\n    );\n  };\n\n// ============== 段落9.1：HypothesisFactorsAndScoresCard（完整函数） ==============\nconst HypothesisFactorsAndScoresCard = ({ node, isEvaluating, showAfter }) => {\n  // 新 color scheme\n  const noveltyColor = '#618685';\n  const feasibilityColor = '#50394c';\n  const impactColor = '#4040a1';\n\n  const hasBefore = !!node.previousState;\n\n  if (isEvaluating) {\n    return (\n      <div style={{ marginBottom: '16px' }}>\n        <p style={{ fontSize: '0.875rem', color: '#6b7280' }}>\n          Scores will be displayed once evaluation is complete.\n        </p>\n      </div>\n    );\n  }\n\n  // 根据 showAfter 判断当前显示的 score / reason\n  const noveltyScore = showAfter || !hasBefore ? node.noveltyScore : node.previousState.noveltyScore;\n  const feasibilityScore = showAfter || !hasBefore ? node.feasibilityScore : node.previousState.feasibilityScore;\n  const impactScore = showAfter || !hasBefore ? node.impactScore : node.previousState.impactScore;\n\n  const noveltyReason = showAfter || !hasBefore ? node.noveltyReason : node.previousState.noveltyReason;\n  const feasibilityReason = showAfter || !hasBefore ? node.feasibilityReason : node.previousState.feasibilityReason;\n  const impactReason = showAfter || !hasBefore ? node.impactReason : node.previousState.impactReason;\n\n  // 去掉外层卡片，直接渲染三个要素\n  return (\n    <>\n      {/* Novelty */}\n      <FactorBlock\n        label=\"Novelty\"\n        color={noveltyColor}\n        score={noveltyScore}\n        reason={noveltyReason}\n        beforeVal={hasBefore ? node.previousState.noveltyScore : null}\n        afterVal={node.noveltyScore}\n        showAfter={showAfter}\n      />\n\n      {/* Feasibility */}\n      <FactorBlock\n        label=\"Feasibility\"\n        color={feasibilityColor}\n        score={feasibilityScore}\n        reason={feasibilityReason}\n        beforeVal={hasBefore ? node.previousState.feasibilityScore : null}\n        afterVal={node.feasibilityScore}\n        showAfter={showAfter}\n      />\n\n      {/* Impact */}\n      <FactorBlock\n        label=\"Impact\"\n        color={impactColor}\n        score={impactScore}\n        reason={impactReason}\n        beforeVal={hasBefore ? node.previousState.impactScore : null}\n        afterVal={node.impactScore}\n        showAfter={showAfter}\n      />\n    </>\n  );\n};\n\nconst FactorBlock = ({ label, color, score, reason, beforeVal, afterVal, showAfter }) => {\n  const getArrowDiv = (beforeVal, afterVal) => {\n    const b = parseFloat(beforeVal);\n    const a = parseFloat(afterVal);\n    if (isNaN(b) || isNaN(a)) return null;\n\n    if (a > b) {\n      // green arrow\n      return (\n        <svg\n          width=\"17\"\n          height=\"17\"\n          viewBox=\"0 0 17 17\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          style={{ margin: '0 6px' }}\n        >\n          <g>\n            <path\n              d=\"M7.01221 4.32837L13.0122 4.32837L13.0122 10.3284\"\n              stroke=\"#37A219\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n            <path\n              d=\"M4.52682 12.8137L13.0121 4.32845\"\n              stroke=\"#37A219\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </g>\n        </svg>\n      );\n    } else if (a < b) {\n      // red arrow\n      return (\n        <svg\n          width=\"17\"\n          height=\"17\"\n          viewBox=\"0 0 17 17\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          style={{ margin: '0 6px' }}\n        >\n          <g>\n            <path\n              d=\"M12.9168 7.19702V13.197H6.91684\"\n              stroke=\"#A21919\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n            <path\n              d=\"M4.43146 4.71167L12.9167 13.1969\"\n              stroke=\"#A21919\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </g>\n        </svg>\n      );\n    } else {\n      // 相同 -> 横线\n      return (\n        <svg\n          width=\"16\"\n          height=\"17\"\n          viewBox=\"0 0 16 17\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          style={{ margin: '0 6px' }}\n        >\n          <g id=\"Frame\">\n            <path\n              id=\"Vector\"\n              d=\"M2.97964 8.17383L13.0204 8.17383\"\n              stroke=\"#A2A2A2\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </g>\n        </svg>\n      );\n    }\n  };\n\n  const hasBefore = beforeVal !== null;\n  let scoreDisplay;\n  if (hasBefore) {\n    scoreDisplay = (\n      <div style={{ display: 'flex', alignItems: 'center', fontSize: '1rem', color: '#374151' }}>\n        <span>{beforeVal}</span>\n        {getArrowDiv(beforeVal, afterVal)}\n        <span>{afterVal}</span>\n      </div>\n    );\n  } else {\n    scoreDisplay = (\n      <div style={{ fontSize: '1rem', color: '#374151' }}>\n        Score: {score}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      style={{\n        backgroundColor: '#F9FAFB',\n        border: '1px solid #E5E7EB',\n        borderRadius: '8px',\n        padding: '16px',\n        marginBottom: '16px',\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center', marginBottom: '8px' }}>\n        <div\n          style={{\n            width: '12px',\n            height: '12px',\n            borderRadius: '50%',\n            backgroundColor: color,\n            marginRight: '8px',\n          }}\n        />\n        <div style={{ fontSize: '1rem', fontWeight: '600', paddingRight: '1em', color }}>{label}</div>{scoreDisplay}\n      </div>\n      <div\n        style={{\n          fontSize: '0.875rem',\n          color: '#111827',\n          lineHeight: '1.4',\n          marginBottom: '12px',\n          whiteSpace: 'pre-wrap',\n        }}\n      >\n        {reason || '(No reason provided)'}\n      </div>\n    </div>\n  );\n};\n\nconst Dashboard = ({ node, isEvaluating, showTree }) => {\n  // 新增 state 用于统一控制\"After/Before\"\n  const [showAfter, setShowAfter] = useState(true);\n\n  if (!node) {\n    return (\n      <div\n        style={{\n          padding: '24px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '160px',\n          color: '#9ca3af',\n        }}\n      >\n        <p>Click on a node to view details</p>\n      </div>\n    );\n  }\n\n  // 仅在 node 被修改过时，才显示 toggle\n  // const hasPrevious = !!node.previousState;\n\n  return (\n    // 整个 dashboard\n    <div\n      style={{\n        border: '1px solid #E5E7EB',\n        borderRadius: '8px',\n        backgroundColor: '#FFFFFF',\n        padding: '16px',\n      }}\n    >\n      {/* 如果 node 被修改过，就在这里放一个 toggle 按钮，而不是在HypothesisFactorsAndScoresCard里 */}\n      {/* {hasPrevious && (\n        <div style={{ display: 'flex', justifyContent: 'flex-end', marginBottom: '12px' }}>\n          <button\n            onClick={() => setShowAfter((prev) => !prev)}\n            style={{\n              padding: '6px 12px',\n              borderRadius: '9999px',\n              border: 'none',\n              cursor: 'pointer',\n              backgroundColor: '#E5E7EB',\n            }}\n          >\n            {showAfter ? 'After' : 'Before'}\n          </button>\n        </div>\n      )} */}\n\n      {/* Hypothesis Card */}\n      <HypothesisCard node={node} showAfter={showAfter} setShowAfter={setShowAfter} />\n\n      {/* 合并的三要素 + 分数卡片 */}\n      <HypothesisFactorsAndScoresCard\n        node={node}\n        isEvaluating={isEvaluating}\n        showAfter={showAfter}\n      />\n\n      {showTree ? (\n        // Exploration View 下方替换成：Add context + Generate\n        <ContextAndGenerateCard />\n      ) : null}\n    </div>\n  );\n};\n\n  // ============== 段落10：其余子组件 ==============\n  // const IVDVCard = ({ node }) => {\n  //   const [isAfterIVDV, setIsAfterIVDV] = useState(true);\n\n  //   const SwitchButton = () => (\n  //     <div\n  //       onClick={() => setIsAfterIVDV((prev) => !prev)}\n  //       style={{\n  //         position: 'absolute',\n  //         top: '12px',\n  //         right: '12px',\n  //         cursor: 'pointer',\n  //       }}\n  //     >\n  //       <div\n  //         style={{\n  //           width: '100%',\n  //           height: '100%',\n  //           background: '#EEEEEE',\n  //           borderRadius: 62,\n  //           overflow: 'hidden',\n  //           justifyContent: 'flex-start',\n  //           alignItems: 'center',\n  //           display: 'inline-flex',\n  //         }}\n  //       >\n  //         <div\n  //           style={{\n  //             width: 42,\n  //             height: 17,\n  //             background: isAfterIVDV ? '#2E2E2E' : '#EEEEEE',\n  //             borderRadius: 62,\n  //             overflow: 'hidden',\n  //             justifyContent: 'center',\n  //             alignItems: 'center',\n  //             display: 'flex',\n  //             transition: 'all 0.2s ease',\n  //           }}\n  //         >\n  //           <div\n  //             style={{\n  //               color: isAfterIVDV ? '#EEEEEE' : '#2E2E2E',\n  //               fontSize: 10,\n  //               fontFamily: 'Inter',\n  //               fontWeight: 500,\n  //               wordWrap: 'break-word',\n  //             }}\n  //           >\n  //             After\n  //           </div>\n  //         </div>\n  //         <div\n  //           style={{\n  //             width: 40,\n  //             height: 20,\n  //             background: isAfterIVDV ? '#EEEEEE' : '#2E2E2E',\n  //             borderRadius: 62,\n  //             overflow: 'hidden',\n  //             justifyContent: 'center',\n  //             alignItems: 'center',\n  //             display: 'flex',\n  //             transition: 'all 0.2s ease',\n  //           }}\n  //         >\n  //           <div\n  //             style={{\n  //               color: isAfterIVDV ? '#2E2E2E' : '#EEEEEE',\n  //               fontSize: 10,\n  //               fontFamily: 'Inter',\n  //               fontWeight: 500,\n  //               wordWrap: 'break-word',\n  //             }}\n  //           >\n  //             Before\n  //           </div>\n  //         </div>\n  //       </div>\n  //     </div>\n  //   );\n\n  //   return (\n  //     <div\n  //       style={{\n  //         position: 'relative',\n  //         border: '1px solid #e5e7eb',\n  //         borderRadius: '8px',\n  //         backgroundColor: '#FAFAFA',\n  //         padding: '16px',\n  //         marginBottom: '16px',\n  //       }}\n  //     >\n  //       {/* <SwitchButton /> */}\n\n  //       {/* Relationship */}\n  //       <div\n  //         style={{\n  //           backgroundColor: '#F9FAFB',\n  //           padding: '12px',\n  //           borderRadius: '6px',\n  //         }}\n  //       >\n  //         <div\n  //           style={{\n  //             marginTop: '4px',\n  //             color: '#374151',\n  //             fontSize: '0.875rem',\n  //             lineHeight: '1.5',\n  //             whiteSpace: 'pre-wrap',\n  //           }}\n  //         >\n  //           {node.content}\n  //         </div>\n  //       </div>\n  //     </div>\n  //   );\n  // };\n\n  const handleAddCustomHypothesis = async (e) => {\n    e.preventDefault();\n    if (!customHypothesis.title.trim() || !customHypothesis.content.trim()) return;\n\n    setIsGenerating(true);\n    setError(null);\n\n    try {\n      const newId = generateUniqueId();\n      const newHypothesis = {\n        id: newId,\n        ...customHypothesis,\n      };\n\n      // 添加到假设列表\n      const updatedHypothesesList = [...hypothesesList, newHypothesis];\n      setHypothesesList(updatedHypothesesList);\n\n      // 创建新节点\n      const newNode = {\n        id: newId,\n        level: selectedNode ? selectedNode.level + 1 : 1,\n        title: customHypothesis.title.trim(),\n        content: customHypothesis.content.trim(),\n        type: 'complex',\n        x: selectedNode ? selectedNode.x + Math.random() * 20 - 10 : 0,\n        y: selectedNode ? selectedNode.y + 150 + Math.random() * 20 - 10 : 150,\n      };\n\n      // 添加节点和连接\n      setNodes((prev) => [...prev, newNode]);\n      if (selectedNode) {\n        setLinks((prev) => [...prev, { source: selectedNode.id, target: newId }]);\n      }\n\n      // 评估新假设\n      await evaluateHypotheses(updatedHypothesesList);\n\n      // 重置表单\n      setCustomHypothesis({ title: '', content: '' });\n      setIsAddingCustom(false);\n    } catch (err) {\n      console.error('Error adding custom hypothesis:', err);\n      setError(err.message);\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  const ContextAndGenerateCard = () => {\n    return (\n      <div\n        style={{\n          border: '1px solid #e5e7eb',\n          borderRadius: '8px',\n          backgroundColor: '#FAFAFA',\n          padding: '16px',\n          marginBottom: '16px',\n        }}\n      >\n        {!isAddingCustom ? (\n          <div onClick={(e) => e.stopPropagation()}>\n            <div style={{ marginBottom: '8px', fontSize: '0.875rem', color: '#6b7280' }}>\n              Add context for new hypotheses (optional)\n            </div>\n            <textarea\n              rows={2}\n              value={userInput}\n              onChange={(e) => setUserInput(e.target.value)}\n              onClick={(e) => e.stopPropagation()}\n              style={{\n                width: '100%',\n                fontSize: '0.875rem',\n                padding: '8px',\n                border: '1px solid #d1d5db',\n                borderRadius: '4px',\n                resize: 'none',\n                marginBottom: '10px',\n              }}\n            />\n\n            <div style={{ display: 'flex', gap: '8px' }}>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  generateChildNodes();\n                }}\n                disabled={!selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted}\n                style={{\n                  padding: '8px 16px',\n                  backgroundColor: '#4C84FF',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                  cursor: !selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted ? 'not-allowed' : 'pointer',\n                  opacity: !selectedNode || isGenerating || isEvaluating || !isAnalysisSubmitted ? 0.6 : 1,\n                }}\n              >\n                Generate New Hypotheses\n              </button>\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  setIsAddingCustom(true);\n                }}\n                style={{\n                  padding: '8px 16px',\n                  backgroundColor: '#fff',\n                  color: '#4C84FF',\n                  border: '1px solid #4C84FF',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                  cursor: 'pointer',\n                }}\n              >\n                Add Custom Hypothesis\n              </button>\n            </div>\n          </div>\n        ) : (\n          <form \n            onSubmit={(e) => {\n              e.stopPropagation();\n              handleAddCustomHypothesis(e);\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div style={{ marginBottom: '12px' }}>\n              <label style={{ display: 'block', marginBottom: '4px', fontSize: '0.875rem', color: '#374151' }}>\n                Title (2-3 words)\n              </label>\n              <input\n                type=\"text\"\n                value={customHypothesis.title}\n                onChange={(e) => setCustomHypothesis(prev => ({ ...prev, title: e.target.value }))}\n                onClick={(e) => e.stopPropagation()}\n                style={{\n                  width: '100%',\n                  padding: '8px',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                }}\n                required\n              />\n            </div>\n            \n            <div style={{ marginBottom: '12px' }}>\n              <label style={{ display: 'block', marginBottom: '4px', fontSize: '0.875rem', color: '#374151' }}>\n                Hypothesis Content\n              </label>\n              <textarea\n                value={customHypothesis.content}\n                onChange={(e) => setCustomHypothesis(prev => ({ ...prev, content: e.target.value }))}\n                onClick={(e) => e.stopPropagation()}\n                rows={4}\n                style={{\n                  width: '100%',\n                  padding: '8px',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                  resize: 'vertical',\n                }}\n                required\n              />\n            </div>\n\n            <div style={{ display: 'flex', gap: '8px' }}>\n              <button\n                type=\"submit\"\n                disabled={isGenerating || isEvaluating}\n                onClick={(e) => e.stopPropagation()}\n                style={{\n                  padding: '8px 16px',\n                  backgroundColor: '#4C84FF',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                  cursor: isGenerating || isEvaluating ? 'not-allowed' : 'pointer',\n                  opacity: isGenerating || isEvaluating ? 0.6 : 1,\n                }}\n              >\n                Add Hypothesis\n              </button>\n              <button\n                type=\"button\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  setIsAddingCustom(false);\n                  setCustomHypothesis({ title: '', content: '' });\n                }}\n                style={{\n                  padding: '8px 16px',\n                  backgroundColor: '#fff',\n                  color: '#374151',\n                  border: '1px solid #d1d5db',\n                  borderRadius: '4px',\n                  fontSize: '0.875rem',\n                  cursor: 'pointer',\n                }}\n              >\n                Cancel\n              </button>\n            </div>\n          </form>\n        )}\n      </div>\n    );\n  };\n\n  // ============== 段落11：整体布局，渲染主界面 JSX ==============\n  return (\n    <div style={{ fontFamily: 'Arial, sans-serif', position: 'relative' }}>\n      <TopNav />\n\n      {showTree && !isAnalysisSubmitted && (\n        <div style={{ backgroundColor: '#1f2937', display: 'flex', alignItems: 'center', padding: '10px 20px' }}>\n          <form onSubmit={handleAnalysisIntentSubmit} style={{ display: 'flex', alignItems: 'center' }}>\n            <input\n              type=\"text\"\n              value={analysisIntent}\n              onChange={(e) => setAnalysisIntent(e.target.value)}\n              placeholder=\"Enter analysis intent\"\n              style={{ padding: '6px 10px', borderRadius: '4px', border: '1px solid #d1d5db', marginRight: '8px' }}\n            />\n            <button\n              type=\"submit\"\n              disabled={isGenerating || isEvaluating}\n              style={{\n                padding: '6px 12px',\n                backgroundColor: '#4C84FF',\n                color: 'white',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: isGenerating || isEvaluating ? 'not-allowed' : 'pointer',\n                opacity: isGenerating || isEvaluating ? 0.7 : 1,\n              }}\n            >\n              {isEvaluating ? 'Evaluating...' : isGenerating ? 'Generating...' : 'Submit'}\n            </button>\n            {error && <div style={{ marginLeft: '16px', color: '#dc2626', fontSize: '0.875rem' }}>{error}</div>}\n          </form>\n        </div>\n      )}\n\n      <div style={{ display: 'flex', padding: '20px', maxWidth: '1600px', margin: '0 auto', boxSizing: 'border-box' }}>\n        {/* 左侧图 */}\n        <div style={{ flexBasis: '60%', marginRight: '20px' }}>\n          <svg ref={svgRef} />\n        </div>\n\n        {/* 右侧 Dashboard */}\n        <div style={{ flexBasis: '40%' }}>\n          {/* {(isGenerating || isEvaluating) && (\n            <div style={{ textAlign: 'center', marginBottom: '10px', color: '#4C84FF' }}>\n              {isGenerating ? 'Generating...' : 'Evaluating...'}\n            </div>\n          )} */}\n          <Dashboard node={nodes.find((n) => n.id === (hoveredNode?.id || selectedNode?.id))} isEvaluating={isEvaluating} showTree={showTree} />\n        </div>\n      </div>\n\n      {/* ========== 段落12：悬浮确认修改的按钮 (pendingChange) ========== */}\n      {pendingChange && (\n        <div\n          style={{\n            position: 'absolute',\n            left: pendingChange.screenX,\n            top: pendingChange.screenY,\n            backgroundColor: '#f3f4f6',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            padding: '6px 8px',\n            zIndex: 999,\n          }}\n        >\n          <div style={{ marginBottom: '4px', fontSize: '0.875rem', color: '#374151' }}>\n            <strong>Confirm change?</strong>\n          </div>\n          <button\n            style={{\n              padding: '4px 8px',\n              backgroundColor: '#4C84FF',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              marginRight: '8px',\n              cursor: 'pointer',\n            }}\n            onClick={() => {\n              modifyHypothesisBasedOnModifications(\n                pendingChange.originalNode,\n                pendingChange.ghostNode,\n                pendingChange.modifications,\n                pendingChange.behindNode\n              );\n              setPendingChange(null);\n            }}\n          >\n            Confirm\n          </button>\n\n          <button\n            style={{\n              padding: '4px 8px',\n              backgroundColor: '#fff',\n              color: '#374151',\n              border: '1px solid #d1d5db',\n              borderRadius: '4px',\n              cursor: 'pointer',\n            }}\n            onClick={() => {\n              setNodes((prev) => prev.filter((nd) => nd.id !== pendingChange.ghostNode.id));\n              setLinks((prev) => prev.filter((lk) => lk.target !== pendingChange.ghostNode.id));\n              setPendingChange(null);\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// ============== 段落13：默认导出 ==============\nexport default TreePlotVisualization;"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAO,KAAKC,EAAE,MAAM,IAAI;AACxB,OAAOC,YAAY,MAAM,qBAAqB,CAAC,CAAC;;AAEhD;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,qBAAqB,GAAGA,CAAA,KAAM;EAAAC,GAAA;EAAA,IAAAC,EAAA,GAAAC,YAAA;EAClC;EACA,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAChD,MAAM,CAACe,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACiB,KAAK,EAAEC,QAAQ,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACmB,WAAW,EAAEC,cAAc,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACqB,YAAY,EAAEC,eAAe,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACuB,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACyB,cAAc,EAAEC,iBAAiB,CAAC,GAAG1B,QAAQ,CAAC,EAAE,CAAC;EACxD,MAAM,CAAC2B,mBAAmB,EAAEC,sBAAsB,CAAC,GAAG5B,QAAQ,CAAC,KAAK,CAAC;EACrE,MAAM,CAAC6B,YAAY,EAAEC,eAAe,CAAC,GAAG9B,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAAC+B,YAAY,EAAEC,eAAe,CAAC,GAAGhC,QAAQ,CAAC,KAAK,CAAC;EACvD,MAAM,CAACiC,KAAK,EAAEC,QAAQ,CAAC,GAAGlC,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAMmC,MAAM,GAAGjC,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAM,CAACkC,cAAc,EAAEC,iBAAiB,CAAC,GAAGrC,QAAQ,CAAC,EAAE,CAAC;EACxD;EACA,MAAM,CAACsC,aAAa,EAAEC,gBAAgB,CAAC,GAAGvC,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACwC,cAAc,EAAEC,iBAAiB,CAAC,GAAGzC,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAAC0C,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG3C,QAAQ,CAAC;IAAE4C,KAAK,EAAE,EAAE;IAAEC,OAAO,EAAE;EAAG,CAAC,CAAC;;EAEpF;EACA,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAG/C,QAAQ,CAAC,kBAAkB,CAAC;EAClE,MAAM,CAACgD,WAAW,EAAEC,cAAc,CAAC,GAAGjD,QAAQ,CAAC,cAAc,CAAC;;EAE9D;EACA,MAAMkD,YAAY,GAAGhD,MAAM,CAAC,CAAC,CAAC;EAC9B,MAAMiD,gBAAgB,GAAGA,CAAA,KAAM;IAC7BD,YAAY,CAACE,OAAO,IAAI,CAAC;IACzB,OAAO,QAAQF,YAAY,CAACE,OAAO,EAAE;EACvC,CAAC;;EAED;EACA,MAAMC,QAAQ,GAAG;IACfC,IAAI,EAAE,SAAS;IACfC,MAAM,EAAE,SAAS;IACjBC,OAAO,EAAE;EACX,CAAC;;EAED;EACA,MAAMC,kBAAkB,GAAG,MAAOC,UAAU,IAAK;IAC/C1B,eAAe,CAAC,IAAI,CAAC;IACrBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMyB,MAAM,GAAG;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAEC,IAAI,CAACC,SAAS,CAACH,UAAU,CAAC;AAC5B;AACA,gBAAgBE,IAAI,CAACC,SAAS,CAACzD,YAAY,CAAC;AAC5C;AACA,qDAAqD;MAE/C,MAAM0D,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;MACnD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAE,UAAUR,MAAM;QACjC,CAAC;QACDS,IAAI,EAAEX,IAAI,CAACC,SAAS,CAAC;UACnBW,KAAK,EAAE,QAAQ;UACfC,QAAQ,EAAE,CACR;YAAEC,IAAI,EAAE,QAAQ;YAAE7B,OAAO,EAAE;UAA4B,CAAC,EACxD;YAAE6B,IAAI,EAAE,MAAM;YAAE7B,OAAO,EAAEc;UAAO,CAAC,CAClC;UACDgB,UAAU,EAAE;QACd,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACT,QAAQ,CAACU,EAAE,EAAE;QAChB,MAAMC,SAAS,GAAG,MAAMX,QAAQ,CAACY,IAAI,CAAC,CAAC;QACvC,MAAM,IAAIC,KAAK,CAACF,SAAS,CAAC5C,KAAK,CAAC+C,OAAO,CAAC;MAC1C;MAEA,MAAMC,IAAI,GAAG,MAAMf,QAAQ,CAACY,IAAI,CAAC,CAAC;MAClC,MAAMI,cAAc,GAAGD,IAAI,CAACE,OAAO,CAAC,CAAC,CAAC,CAACH,OAAO,CAACnC,OAAO,CAACuC,IAAI,CAAC,CAAC;MAE7D,IAAIC,mBAAmB;MACvB,IAAI;QACF,MAAMC,SAAS,GAAGJ,cAAc,CAACK,KAAK,CAAC,SAAS,CAAC;QACjD,IAAID,SAAS,EAAE;UACbD,mBAAmB,GAAGzB,IAAI,CAAC4B,KAAK,CAACF,SAAS,CAAC,CAAC,CAAC,CAAC;QAChD,CAAC,MAAM;UACLD,mBAAmB,GAAGzB,IAAI,CAAC4B,KAAK,CAACN,cAAc,CAAC;QAClD;MACF,CAAC,CAAC,OAAOO,UAAU,EAAE;QACnB,MAAM,IAAIV,KAAK,CAAC,uEAAuE,CAAC;MAC1F;MAEA,IAAIM,mBAAmB,CAACK,MAAM,KAAKhC,UAAU,CAACgC,MAAM,EAAE;QACpD,MAAM,IAAIX,KAAK,CACb,wDAAwDrB,UAAU,CAACgC,MAAM,aAAaL,mBAAmB,CAACK,MAAM,GAClH,CAAC;MACH;;MAEA;MACA,MAAMC,WAAW,GAAGA,CAACC,IAAI,EAAEC,KAAK,KAAK;QACnC,MAAMC,QAAQ,GAAG,EAAE;QACnB,MAAMC,QAAQ,GAAG,EAAE;QACnB,MAAMC,UAAU,GAAGF,QAAQ,GAAGC,QAAQ;QACtC;QACA,MAAME,KAAK,GAAGH,QAAQ,GAAI,CAACF,IAAI,GAAG,CAAC,IAAII,UAAU,IAAKH,KAAK,GAAG,CAAC,CAAC;QAChE,OAAOK,IAAI,CAACC,KAAK,CAACF,KAAK,CAAC;MAC1B,CAAC;MAEDjF,QAAQ,CAAEoF,SAAS,IACjBA,SAAS,CAACC,GAAG,CAAEC,IAAI,IAAK;QACtB,MAAMC,QAAQ,GAAGlB,mBAAmB,CAACmB,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,KAAKJ,IAAI,CAACI,EAAE,CAAC;QAClE,IAAIH,QAAQ,EAAE;UACZ,MAAMI,eAAe,GAAGjD,UAAU,CAACgC,MAAM;UACzC,MAAMkB,YAAY,GAAGjB,WAAW,CAACY,QAAQ,CAACM,YAAY,EAAEF,eAAe,CAAC;UACxE,MAAMG,gBAAgB,GAAGnB,WAAW,CAACY,QAAQ,CAACQ,gBAAgB,EAAEJ,eAAe,CAAC;UAChF,MAAMK,WAAW,GAAGrB,WAAW,CAACY,QAAQ,CAACU,WAAW,EAAEN,eAAe,CAAC;UAEtE,OAAO;YACL,GAAGL,IAAI;YACPM,YAAY;YACZE,gBAAgB;YAChBE,WAAW;YACXE,aAAa,EAAEX,QAAQ,CAACY,mBAAmB,IAAI,sBAAsB;YACrEC,iBAAiB,EAAEb,QAAQ,CAACc,uBAAuB,IAAI,sBAAsB;YAC7EC,YAAY,EAAEf,QAAQ,CAACgB,kBAAkB,IAAI;UAC/C,CAAC;QACH;QACA,OAAOjB,IAAI;MACb,CAAC,CACH,CAAC;IACH,CAAC,CAAC,OAAOkB,GAAG,EAAE;MACZC,OAAO,CAACxF,KAAK,CAAC,8BAA8B,EAAEuF,GAAG,CAAC;MAClDtF,QAAQ,CAACsF,GAAG,CAACxC,OAAO,CAAC;IACvB,CAAC,SAAS;MACRhD,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;;EAED;EACA,MAAM0F,0BAA0B,GAAG,MAAOC,CAAC,IAAK;IAC9CA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI,CAACnG,cAAc,CAAC2D,IAAI,CAAC,CAAC,EAAE;IAE5BtD,eAAe,CAAC,IAAI,CAAC;IACrBI,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMyB,MAAM,GAAG;AACrB;AACA,mBAAmBlC,cAAc;AACjC;AACA,QAAQmC,IAAI,CAACC,SAAS,CAACzD,YAAY,CAAC;AACpC;AACA,qDAAqD;MAE/C,MAAM0D,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;MACnD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAE,UAAUR,MAAM;QACjC,CAAC;QACDS,IAAI,EAAEX,IAAI,CAACC,SAAS,CAAC;UACnBW,KAAK,EAAE,QAAQ;UACfC,QAAQ,EAAE,CACR;YAAEC,IAAI,EAAE,QAAQ;YAAE7B,OAAO,EAAE;UAA4B,CAAC,EACxD;YAAE6B,IAAI,EAAE,MAAM;YAAE7B,OAAO,EAAEc;UAAO,CAAC,CAClC;UACDgB,UAAU,EAAE;QACd,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACT,QAAQ,CAACU,EAAE,EAAE;QAChB,MAAMC,SAAS,GAAG,MAAMX,QAAQ,CAACY,IAAI,CAAC,CAAC;QACvC,MAAM,IAAIC,KAAK,CAACF,SAAS,CAAC5C,KAAK,CAAC+C,OAAO,CAAC;MAC1C;MAEA,MAAMC,IAAI,GAAG,MAAMf,QAAQ,CAACY,IAAI,CAAC,CAAC;MAClC,MAAMI,cAAc,GAAGD,IAAI,CAACE,OAAO,CAAC,CAAC,CAAC,CAACH,OAAO,CAACnC,OAAO,CAACuC,IAAI,CAAC,CAAC;MAE7D,IAAIyC,eAAe;MACnB,IAAI;QACF,MAAMvC,SAAS,GAAGJ,cAAc,CAACK,KAAK,CAAC,SAAS,CAAC;QACjD,IAAID,SAAS,EAAE;UACbuC,eAAe,GAAGjE,IAAI,CAAC4B,KAAK,CAACF,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,MAAM;UACLuC,eAAe,GAAGjE,IAAI,CAAC4B,KAAK,CAACN,cAAc,CAAC;QAC9C;MACF,CAAC,CAAC,OAAOO,UAAU,EAAE;QACnB,MAAM,IAAIV,KAAK,CAAC,6DAA6D,CAAC;MAChF;MAEA,MAAMrB,UAAU,GAAGmE,eAAe,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;MAC9C,MAAMC,gBAAgB,GAAGrE,UAAU,CAAC2C,GAAG,CAAE2B,GAAG,IAAK;QAC/C,MAAMtB,EAAE,GAAGvD,gBAAgB,CAAC,CAAC;QAC7B,OAAO;UAAEuD,EAAE;UAAE,GAAGsB;QAAI,CAAC;MACvB,CAAC,CAAC;MAEF,MAAMC,qBAAqB,GAAG,CAAC,GAAG7F,cAAc,EAAE,GAAG2F,gBAAgB,CAAC;MACtE1F,iBAAiB,CAAC4F,qBAAqB,CAAC;;MAExC;MACA,MAAMC,QAAQ,GAAG;QACfxB,EAAE,EAAE,MAAM;QACVyB,KAAK,EAAE,CAAC;QACRvF,KAAK,EAAEnB,cAAc;QACrBoB,OAAO,EAAEpB,cAAc;QACvB2G,IAAI,EAAE,MAAM;QACZC,CAAC,EAAE,CAAC;QACJC,CAAC,EAAE;MACL,CAAC;;MAED;MACA,MAAMC,YAAY,GAAG,GAAG;MACxB,MAAMC,UAAU,GAAG,CAAC9E,UAAU,CAACgC,MAAM,GAAG,CAAC,IAAI6C,YAAY;MACzD,MAAME,MAAM,GAAGP,QAAQ,CAACG,CAAC,GAAGG,UAAU,GAAG,CAAC;MAE1C,MAAME,UAAU,GAAGX,gBAAgB,CAAC1B,GAAG,CAAC,CAAC2B,GAAG,EAAEW,CAAC,MAAM;QACnDjC,EAAE,EAAEsB,GAAG,CAACtB,EAAE;QACVyB,KAAK,EAAE,CAAC;QACRvF,KAAK,EAAEoF,GAAG,CAACpF,KAAK,CAACwC,IAAI,CAAC,CAAC;QACvBvC,OAAO,EAAEmF,GAAG,CAACnF,OAAO,CAACuC,IAAI,CAAC,CAAC;QAC3BgD,IAAI,EAAE,SAAS;QACfC,CAAC,EAAEI,MAAM,GAAGE,CAAC,GAAGJ,YAAY;QAC5BD,CAAC,EAAEJ,QAAQ,CAACI,CAAC,GAAG;MAClB,CAAC,CAAC,CAAC;MAEH,MAAMM,QAAQ,GAAG,CAACV,QAAQ,EAAE,GAAGQ,UAAU,CAAC;MAC1C,MAAMG,QAAQ,GAAGH,UAAU,CAACrC,GAAG,CAAEyC,EAAE,KAAM;QAAEC,MAAM,EAAEb,QAAQ,CAACxB,EAAE;QAAEsC,MAAM,EAAEF,EAAE,CAACpC;MAAG,CAAC,CAAC,CAAC;MACjF1F,QAAQ,CAAC4H,QAAQ,CAAC;MAClB1H,QAAQ,CAAC2H,QAAQ,CAAC;MAElBnH,iBAAiB,CAAC,EAAE,CAAC;MACrBE,sBAAsB,CAAC,IAAI,CAAC;;MAE5B;MACA,MAAM6B,kBAAkB,CAACwE,qBAAqB,CAAC;MAC/CnG,eAAe,CAAC,KAAK,CAAC;IACxB,CAAC,CAAC,OAAO0F,GAAG,EAAE;MACZC,OAAO,CAACxF,KAAK,CAAC,sCAAsC,EAAEuF,GAAG,CAAC;MAC1DtF,QAAQ,CAACsF,GAAG,CAACxC,OAAO,CAAC;MACrBlD,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;;EAED;EACA,MAAMmH,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI,CAAC5H,YAAY,EAAE;IACnBS,eAAe,CAAC,IAAI,CAAC;IACrBI,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMyB,MAAM,GAAG;AACrB;AACA,gBAAgBtC,YAAY,CAACwB,OAAO;AACpC;AACA,QAAQe,IAAI,CAACC,SAAS,CAACzD,YAAY,CAAC;AACpC;AACA,sBAAsBmB,SAAS;AAC/B;AACA,qDAAqD;MAE/C,MAAMuC,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;MACnD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAE,UAAUR,MAAM;QACjC,CAAC;QACDS,IAAI,EAAEX,IAAI,CAACC,SAAS,CAAC;UACnBW,KAAK,EAAE,QAAQ;UACfC,QAAQ,EAAE,CACR;YAAEC,IAAI,EAAE,QAAQ;YAAE7B,OAAO,EAAE;UAA4B,CAAC,EACxD;YAAE6B,IAAI,EAAE,MAAM;YAAE7B,OAAO,EAAEc;UAAO,CAAC,CAClC;UACDgB,UAAU,EAAE;QACd,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACT,QAAQ,CAACU,EAAE,EAAE;QAChB,MAAMC,SAAS,GAAG,MAAMX,QAAQ,CAACY,IAAI,CAAC,CAAC;QACvC,MAAM,IAAIC,KAAK,CAACF,SAAS,CAAC5C,KAAK,CAAC+C,OAAO,CAAC;MAC1C;MAEA,MAAMC,IAAI,GAAG,MAAMf,QAAQ,CAACY,IAAI,CAAC,CAAC;MAClC,MAAMI,cAAc,GAAGD,IAAI,CAACE,OAAO,CAAC,CAAC,CAAC,CAACH,OAAO,CAACnC,OAAO,CAACuC,IAAI,CAAC,CAAC;MAE7D,IAAIyC,eAAe;MACnB,IAAI;QACF,MAAMvC,SAAS,GAAGJ,cAAc,CAACK,KAAK,CAAC,SAAS,CAAC;QACjD,IAAID,SAAS,EAAE;UACbuC,eAAe,GAAGjE,IAAI,CAAC4B,KAAK,CAACF,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,MAAM;UACLuC,eAAe,GAAGjE,IAAI,CAAC4B,KAAK,CAACN,cAAc,CAAC;QAC9C;MACF,CAAC,CAAC,OAAOO,UAAU,EAAE;QACnB,MAAM,IAAIV,KAAK,CAAC,6DAA6D,CAAC;MAChF;MAEA,MAAMrB,UAAU,GAAGmE,eAAe,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;MAC9C,MAAMoB,mBAAmB,GAAGxF,UAAU,CAAC2C,GAAG,CAAE2B,GAAG,IAAK;QAClD,MAAMtB,EAAE,GAAGvD,gBAAgB,CAAC,CAAC;QAC7B,OAAO;UAAEuD,EAAE;UAAE,GAAGsB;QAAI,CAAC;MACvB,CAAC,CAAC;MAEF,MAAMC,qBAAqB,GAAG,CAAC,GAAG7F,cAAc,EAAE,GAAG8G,mBAAmB,CAAC;MACzE7G,iBAAiB,CAAC4F,qBAAqB,CAAC;;MAExC;MACA,MAAMM,YAAY,GAAG,GAAG;MACxB,MAAMC,UAAU,GAAG,CAAC9E,UAAU,CAACgC,MAAM,GAAG,CAAC,IAAI6C,YAAY;MACzD,MAAME,MAAM,GAAGpH,YAAY,CAACgH,CAAC,GAAGG,UAAU,GAAG,CAAC;MAE9C,MAAMI,QAAQ,GAAGM,mBAAmB,CAAC7C,GAAG,CAAC,CAAC2B,GAAG,EAAEW,CAAC,MAAM;QACpDjC,EAAE,EAAEsB,GAAG,CAACtB,EAAE;QACVyB,KAAK,EAAE9G,YAAY,CAAC8G,KAAK,GAAG,CAAC;QAC7BvF,KAAK,EAAEoF,GAAG,CAACpF,KAAK,CAACwC,IAAI,CAAC,CAAC;QACvBvC,OAAO,EAAEmF,GAAG,CAACnF,OAAO,CAACuC,IAAI,CAAC,CAAC;QAC3BgD,IAAI,EAAE,SAAS;QACfC,CAAC,EAAEI,MAAM,GAAGE,CAAC,GAAGJ,YAAY,GAAGrC,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE;QACtDb,CAAC,EAAEjH,YAAY,CAACiH,CAAC,GAAG,GAAG,GAAGpC,IAAI,CAACiD,MAAM,CAAC,CAAC,GAAG,EAAE,GAAG;MACjD,CAAC,CAAC,CAAC;MAEH,MAAMN,QAAQ,GAAGD,QAAQ,CAACvC,GAAG,CAAEyC,EAAE,KAAM;QAAEC,MAAM,EAAE1H,YAAY,CAACqF,EAAE;QAAEsC,MAAM,EAAEF,EAAE,CAACpC;MAAG,CAAC,CAAC,CAAC;MACnF1F,QAAQ,CAAEoI,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE,GAAGR,QAAQ,CAAC,CAAC;MAC1C1H,QAAQ,CAAEkI,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE,GAAGP,QAAQ,CAAC,CAAC;;MAE1C;MACA,MAAMpF,kBAAkB,CAACwE,qBAAqB,CAAC;MAE/CnG,eAAe,CAAC,KAAK,CAAC;MACtBN,YAAY,CAAC,EAAE,CAAC;IAClB,CAAC,CAAC,OAAOgG,GAAG,EAAE;MACZC,OAAO,CAACxF,KAAK,CAAC,8BAA8B,EAAEuF,GAAG,CAAC;MAClDtF,QAAQ,CAACsF,GAAG,CAACxC,OAAO,CAAC;MACrBlD,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;;EAED;EACA;EACA,MAAMuH,oCAAoC,GAAG,MAAAA,CAC3CC,YAAY,EACZC,SAAS,EACTC,aAAa,EACbC,UAAU,KACP;IACHvH,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACFJ,eAAe,CAAC,IAAI,CAAC;;MAErB;MACA,IAAI4H,gBAAgB,GAAG,EAAE;MACzB,MAAMC,iBAAiB,GAAGF,UAAU,GAAGA,UAAU,CAAC5G,OAAO,GAAG,wBAAwB;MAEpF2G,aAAa,CAACI,OAAO,CAAEC,GAAG,IAAK;QAC7B,MAAMC,UAAU,GACdD,GAAG,CAACE,MAAM,KAAK,cAAc,GACzB,SAAS,GACTF,GAAG,CAACE,MAAM,KAAK,kBAAkB,GACjC,aAAa,GACb,QAAQ;QACd,MAAMC,SAAS,GAAGH,GAAG,CAACG,SAAS,KAAK,UAAU,GAAG,YAAY,GAAG,YAAY;QAC5E,MAAMC,IAAI,GAAG,MAAMD,SAAS,QAAQF,UAAU,SAC5CE,SAAS,KAAK,YAAY,GAAG,MAAM,GAAG,MAAM,IAC1CF,UAAU,CAACI,WAAW,CAAC,CAAC,2BAA2BP,iBAAiB,EAAE;QAC1ED,gBAAgB,CAACS,IAAI,CAACF,IAAI,CAAC;MAC7B,CAAC,CAAC;MAEF,MAAMG,gBAAgB,GAAGV,gBAAgB,CACtCrD,GAAG,CAAC,CAAC4D,IAAI,EAAEI,GAAG,KAAK;QAClB,IAAIA,GAAG,KAAK,CAAC,EAAE,OAAO,0BAA0BJ,IAAI,EAAE;QACtD,OAAO,OAAOA,IAAI,EAAE;MACtB,CAAC,CAAC,CACDK,IAAI,CAAC,MAAM,CAAC;MAEf,MAAM3G,MAAM,GAAG;AACrB,IAAIyG,gBAAgB;AACpB;AACA;AACA;AACA;AACA,IAAId,YAAY,CAACzG,OAAO;AACxB;AACA,qBAAqBe,IAAI,CAACC,SAAS,CAACzD,YAAY,CAAC;AACjD;AACA;AACA,OAAO,CAACgF,IAAI,CAAC,CAAC;MAGRqC,OAAO,CAAC8C,GAAG,CAAC,gBAAgB,EAAE5G,MAAM,CAAC;MAErC,MAAMG,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,wBAAwB;MACnD,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACzEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClCC,aAAa,EAAE,UAAUR,MAAM;QACjC,CAAC;QACDS,IAAI,EAAEX,IAAI,CAACC,SAAS,CAAC;UACnBW,KAAK,EAAE,QAAQ;UACfC,QAAQ,EAAE,CACR;YAAEC,IAAI,EAAE,QAAQ;YAAE7B,OAAO,EAAE;UAA4B,CAAC,EACxD;YAAE6B,IAAI,EAAE,MAAM;YAAE7B,OAAO,EAAEc;UAAO,CAAC,CAClC;UACDgB,UAAU,EAAE;QACd,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACT,QAAQ,CAACU,EAAE,EAAE;QAChB,MAAMC,SAAS,GAAG,MAAMX,QAAQ,CAACY,IAAI,CAAC,CAAC;QACvC,MAAM,IAAIC,KAAK,CAACF,SAAS,CAAC5C,KAAK,CAAC+C,OAAO,CAAC;MAC1C;MAEA,MAAMC,IAAI,GAAG,MAAMf,QAAQ,CAACY,IAAI,CAAC,CAAC;MAClC,MAAMI,cAAc,GAAGD,IAAI,CAACE,OAAO,CAAC,CAAC,CAAC,CAACH,OAAO,CAACnC,OAAO,CAACuC,IAAI,CAAC,CAAC;MAE7DmE,SAAS,CAAC1G,OAAO,GAAGqC,cAAc;MAClCqE,SAAS,CAACiB,UAAU,GAAG,IAAI;MAC3BjB,SAAS,CAACkB,aAAa,GAAGnB,YAAY;MACtCC,SAAS,CAACmB,OAAO,GAAG,KAAK;MAEzB,MAAMC,aAAa,GAAG;QACpBjE,EAAE,EAAE6C,SAAS,CAAC7C,EAAE;QAChB9D,KAAK,EAAE2G,SAAS,CAAC3G,KAAK;QACtBC,OAAO,EAAEqC;MACX,CAAC;MACD7C,iBAAiB,CAAEuI,QAAQ,IAAK,CAAC,GAAGA,QAAQ,EAAED,aAAa,CAAC,CAAC;MAE7D3J,QAAQ,CAAEoF,SAAS,IAAKA,SAAS,CAACC,GAAG,CAAEwE,CAAC,IAAMA,CAAC,CAACnE,EAAE,KAAK6C,SAAS,CAAC7C,EAAE,GAAG6C,SAAS,GAAGsB,CAAE,CAAC,CAAC;MACtF/I,eAAe,CAAC,KAAK,CAAC;MACtBE,eAAe,CAAC,IAAI,CAAC;MAErB,MAAMyB,kBAAkB,CAAC,CAAC,GAAGrB,cAAc,EAAEuI,aAAa,CAAC,CAAC;IAC9D,CAAC,CAAC,OAAOnD,GAAG,EAAE;MACZC,OAAO,CAACxF,KAAK,CAAC,6BAA6B,EAAEuF,GAAG,CAAC;MACjDtF,QAAQ,CAACsF,GAAG,CAACxC,OAAO,CAAC;MACrBlD,eAAe,CAAC,KAAK,CAAC;IACxB,CAAC,SAAS;MACRE,eAAe,CAAC,KAAK,CAAC;IACxB;EACF,CAAC;EACD;;EAEA;EACA,MAAM8I,eAAe,GAAIxE,IAAI,IAAK;IAChChF,eAAe,CAAE8H,IAAI,IAAM,CAAAA,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE1C,EAAE,MAAKJ,IAAI,CAACI,EAAE,GAAG,IAAI,GAAGJ,IAAK,CAAC;EACjE,CAAC;EACD,MAAMyE,eAAe,GAAGA,CAACC,KAAK,EAAEC,CAAC,KAAK;IACpC7J,cAAc,CAAC6J,CAAC,CAAC;IACjB9K,EAAE,CAAC+K,MAAM,CAACF,KAAK,CAACG,aAAa,CAAC,CAACC,KAAK,CAAC,CAAC;EACxC,CAAC;EACD,MAAMC,eAAe,GAAGA,CAAA,KAAM;IAC5BjK,cAAc,CAAC,IAAI,CAAC;EACtB,CAAC;;EAED;EACAnB,SAAS,CAAC,MAAM;IACd,IAAI,CAACkC,MAAM,CAACiB,OAAO,EAAE;IAErB,MAAMkI,KAAK,GAAG,GAAG;IACjB,MAAMC,MAAM,GAAG,GAAG;;IAElB;IACApL,EAAE,CAAC+K,MAAM,CAAC/I,MAAM,CAACiB,OAAO,CAAC,CAACoI,SAAS,CAAC,GAAG,CAAC,CAACC,MAAM,CAAC,CAAC;IAEjD,IAAI5K,QAAQ,EAAE;MACZ;MACA,MAAM6K,GAAG,GAAGvL,EAAE,CAAC+K,MAAM,CAAC/I,MAAM,CAACiB,OAAO,CAAC,CAACuI,IAAI,CAAC,OAAO,EAAEL,KAAK,CAAC,CAACK,IAAI,CAAC,QAAQ,EAAEJ,MAAM,CAAC;;MAEjF;MACAG,GAAG,CACAE,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZA,IAAI,CAAC,OAAO,EAAEL,KAAK,GAAG,CAAC,CAAC,CACxBK,IAAI,CAAC,QAAQ,EAAEJ,MAAM,GAAG,CAAC,CAAC,CAC1BI,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbE,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC,CACrBA,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC,CAC1BA,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC,CACxBA,KAAK,CAAC,QAAQ,EAAE,wCAAwC,CAAC;MAE5D,MAAMC,CAAC,GAAGJ,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,WAAW,EAAE,qBAAqB,CAAC;;MAElE;MACA1K,KAAK,CAAC2I,OAAO,CAAEmC,IAAI,IAAK;QACtB,MAAMhD,MAAM,GAAGhI,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAChD,MAAM,CAAC;QACtD,MAAMC,MAAM,GAAGjI,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAC/C,MAAM,CAAC;QACtD,IAAID,MAAM,IAAIC,MAAM,EAAE;UACpB8C,CAAC,CAACF,MAAM,CAAC,MAAM,CAAC,CACbD,IAAI,CACH,GAAG,EACH,KAAK5C,MAAM,CAACV,CAAC,IAAIU,MAAM,CAACT,CAAC,MAAMS,MAAM,CAACV,CAAC,IAAI,CAACU,MAAM,CAACT,CAAC,GAAGU,MAAM,CAACV,CAAC,IAAI,CAAC;AAClF,iBAAiBU,MAAM,CAACX,CAAC,IAAI,CAACU,MAAM,CAACT,CAAC,GAAGU,MAAM,CAACV,CAAC,IAAI,CAAC;AACtD,iBAAiBU,MAAM,CAACX,CAAC,IAAIW,MAAM,CAACV,CAAC,EACzB,CAAC,CACAuD,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC,CACrBA,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC,CACvBA,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC;QAC7B;MACF,CAAC,CAAC;;MAEF;MACA,MAAMG,UAAU,GAAGF,CAAC,CACjBN,SAAS,CAAC,OAAO,CAAC,CAClBvG,IAAI,CAAClE,KAAK,CAAC,CACXkL,KAAK,CAAC,CAAC,CACPL,MAAM,CAAC,GAAG,CAAC,CACXD,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CACrBA,IAAI,CAAC,WAAW,EAAGV,CAAC,IAAK,aAAaA,CAAC,CAAC5C,CAAC,IAAI4C,CAAC,CAAC3C,CAAC,GAAG,CAAC;MAEvD0D,UAAU,CACPJ,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CACdA,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC7BO,IAAI,CAAEjB,CAAC,IAAKA,CAAC,CAACrI,KAAK,CAAC,CACpB+I,IAAI,CAAC,gBAAgB,EAAE,MAAM,CAAC;MAEjCK,UAAU,CACPJ,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbE,KAAK,CAAC,MAAM,EAAGZ,CAAC,IAAMA,CAAC,CAACkB,gBAAgB,GAAG,SAAS,GAAG9I,QAAQ,CAAC4H,CAAC,CAAC7C,IAAI,CAAE,CAAC,CACzEyD,KAAK,CAAC,SAAS,EAAGZ,CAAC,IAAMA,CAAC,CAACP,OAAO,GAAG,GAAG,GAAG,CAAE,CAAC,CAC9CmB,KAAK,CAAC,QAAQ,EAAGZ,CAAC,IAAK;QACtB,IAAI,CAAA5J,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEqF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,MAAM,CAAC,KACxC,IAAI,CAAAvF,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,MAAM,CAAC,KAC5C,OAAO,MAAM;MACpB,CAAC,CAAC,CACDmF,KAAK,CAAC,cAAc,EAAGZ,CAAC,IAAK;QAC5B,IAAI,CAAA5J,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEqF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,CAAC,CAAC,KACnC,IAAI,CAAAvF,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,CAAC,CAAC,KACvC,OAAO,CAAC;MACf,CAAC,CAAC,CACDmF,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC,CAC1BO,EAAE,CAAC,YAAY,EAAErB,eAAe,CAAC,CACjCqB,EAAE,CAAC,YAAY,EAAEf,eAAe,CAAC,CACjCe,EAAE,CAAC,OAAO,EAAE,CAACpB,KAAK,EAAEC,CAAC,KAAKH,eAAe,CAACG,CAAC,CAAC,CAAC;;MAEhD;MACA,MAAMoB,OAAO,GAAGX,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,WAAW,EAAE,iBAAiBJ,MAAM,GAAG,EAAE,GAAG,CAAC;MAClFc,OAAO,CACJT,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC;MAC3BQ,OAAO,CACJT,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,WAAW,EAAE,UAAU,CAAC,CAC9BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBK,IAAI,CAAC,QAAQ,CAAC;MACjBG,OAAO,CACJT,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CACfA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC;MAC3BQ,OAAO,CACJT,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CACdA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,WAAW,EAAE,UAAU,CAAC,CAC9BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBK,IAAI,CAAC,qBAAqB,CAAC;MAC9BG,OAAO,CACJT,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CACfA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC;MAC3BQ,OAAO,CACJT,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CACdA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,WAAW,EAAE,UAAU,CAAC,CAC9BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBK,IAAI,CAAC,qBAAqB,CAAC;IAChC,CAAC,MAAM;MACL;MACA,MAAMR,GAAG,GAAGvL,EAAE,CAAC+K,MAAM,CAAC/I,MAAM,CAACiB,OAAO,CAAC,CAACuI,IAAI,CAAC,OAAO,EAAEL,KAAK,CAAC,CAACK,IAAI,CAAC,QAAQ,EAAEJ,MAAM,CAAC;;MAEjF;MACAG,GAAG,CACAE,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZA,IAAI,CAAC,OAAO,EAAEL,KAAK,GAAG,CAAC,CAAC,CACxBK,IAAI,CAAC,QAAQ,EAAEJ,MAAM,GAAG,CAAC,CAAC,CAC1BI,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbE,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC,CACrBA,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC,CAC1BA,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC,CACxBA,KAAK,CAAC,QAAQ,EAAE,wCAAwC,CAAC;MAE5D,MAAMS,MAAM,GAAGZ,GAAG,CACfE,MAAM,CAAC,eAAe,CAAC,CACvBD,IAAI,CAAC,GAAG,EAAEL,KAAK,GAAG,GAAG,CAAC,CACtBK,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,CAClBA,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC;MAErBW,MAAM,CACHV,MAAM,CAAC,WAAW,CAAC,CACnBC,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,CACxBA,KAAK,CAAC,eAAe,EAAE,QAAQ,CAAC,CAChCA,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,CACnBA,KAAK,CAAC,UAAU,EAAE,UAAU,CAAC,CAC7BU,IAAI,CAAC;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,CAAC;MAEF,MAAMC,WAAW,GAAGC,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC;MACtD,MAAMC,WAAW,GAAGF,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC;MACtD,IAAIF,WAAW,EAAEA,WAAW,CAACI,KAAK,GAAG9J,WAAW;MAChD,IAAI6J,WAAW,EAAEA,WAAW,CAACC,KAAK,GAAG5J,WAAW;MAEhD,IAAIwJ,WAAW,EAAE;QACfA,WAAW,CAACK,QAAQ,GAAIlF,CAAC,IAAK5E,cAAc,CAAC4E,CAAC,CAACqB,MAAM,CAAC4D,KAAK,CAAC;MAC9D;MACA,IAAID,WAAW,EAAE;QACfA,WAAW,CAACE,QAAQ,GAAIlF,CAAC,IAAK1E,cAAc,CAAC0E,CAAC,CAACqB,MAAM,CAAC4D,KAAK,CAAC;MAC9D;MAEA,MAAME,MAAM,GAAG;QAAEC,GAAG,EAAE,GAAG;QAAEC,KAAK,EAAE,EAAE;QAAEC,MAAM,EAAE,EAAE;QAAEC,IAAI,EAAE;MAAG,CAAC;MAC5D,MAAMC,UAAU,GAAG7B,KAAK,GAAGwB,MAAM,CAACI,IAAI,GAAGJ,MAAM,CAACE,KAAK;MACrD,MAAMI,WAAW,GAAG7B,MAAM,GAAGuB,MAAM,CAACC,GAAG,GAAGD,MAAM,CAACG,MAAM;MAEvD,MAAMnB,CAAC,GAAGJ,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,WAAW,EAAE,aAAamB,MAAM,CAACI,IAAI,KAAKJ,MAAM,CAACC,GAAG,GAAG,CAAC;MAEvF,MAAMM,MAAM,GAAGlN,EAAE,CAACmN,WAAW,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAEL,UAAU,CAAC,CAAC;MACvE,MAAMM,MAAM,GAAGtN,EAAE,CAACmN,WAAW,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAACC,KAAK,CAAC,CAACJ,WAAW,EAAE,CAAC,CAAC,CAAC;MAExE,MAAMM,KAAK,GAAGvN,EAAE,CACbwN,UAAU,CAACN,MAAM,CAAC,CAClBO,UAAU,CAACzN,EAAE,CAACqN,KAAK,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAChCK,UAAU,CAAC1N,EAAE,CAAC2N,MAAM,CAAC,GAAG,CAAC,CAAC;MAC7B,MAAMC,KAAK,GAAG5N,EAAE,CACb6N,QAAQ,CAACP,MAAM,CAAC,CAChBG,UAAU,CAACzN,EAAE,CAACqN,KAAK,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAChCK,UAAU,CAAC1N,EAAE,CAAC2N,MAAM,CAAC,GAAG,CAAC,CAAC;MAE7B,MAAMG,KAAK,GAAG9N,EAAE,CAACwN,UAAU,CAACN,MAAM,CAAC,CAACO,UAAU,CAACzN,EAAE,CAACqN,KAAK,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAACU,QAAQ,CAAC,CAACd,WAAW,CAAC,CAACS,UAAU,CAAC,EAAE,CAAC;MAC1G,MAAMM,KAAK,GAAGhO,EAAE,CAAC6N,QAAQ,CAACP,MAAM,CAAC,CAACG,UAAU,CAACzN,EAAE,CAACqN,KAAK,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAACU,QAAQ,CAAC,CAACf,UAAU,CAAC,CAACU,UAAU,CAAC,EAAE,CAAC;MAEvG,MAAMO,MAAM,GAAGtC,CAAC,CAACF,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAACA,IAAI,CAAC,WAAW,EAAE,gBAAgByB,WAAW,GAAG,CAAC,CAACiB,IAAI,CAACJ,KAAK,CAAC;MAClHG,MAAM,CAAC5C,SAAS,CAAC,SAAS,CAAC,CAACC,MAAM,CAAC,CAAC;MACpC2C,MAAM,CAAC5C,SAAS,CAAC,YAAY,CAAC,CAACK,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC;MAEzD,MAAMyC,MAAM,GAAGxC,CAAC,CAACF,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC0C,IAAI,CAACF,KAAK,CAAC;MAChEG,MAAM,CAAC9C,SAAS,CAAC,SAAS,CAAC,CAACC,MAAM,CAAC,CAAC;MACpC6C,MAAM,CAAC9C,SAAS,CAAC,YAAY,CAAC,CAACK,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC;MAEzDC,CAAC,CAACF,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,WAAW,EAAE,gBAAgByB,WAAW,GAAG,CAAC,CAACiB,IAAI,CAACX,KAAK,CAAC;MAC3E5B,CAAC,CAACF,MAAM,CAAC,GAAG,CAAC,CAACyC,IAAI,CAACN,KAAK,CAAC;MAEzBjC,CAAC,CACEF,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAEwB,UAAU,GAAG,CAAC,CAAC,CACzBxB,IAAI,CAAC,GAAG,EAAEyB,WAAW,GAAG,EAAE,CAAC,CAC3BvB,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC9BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBA,KAAK,CAAC,WAAW,EAAE,QAAQ,CAAC,CAC5BK,IAAI,CACHpJ,WAAW,KAAK,cAAc,GAC1B,SAAS,GACTA,WAAW,KAAK,kBAAkB,GAClC,aAAa,GACb,QACN,CAAC;MAEHgJ,CAAC,CACEF,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,WAAW,EAAE,aAAa,CAAC,CAChCA,IAAI,CAAC,GAAG,EAAE,CAACyB,WAAW,GAAG,CAAC,CAAC,CAC3BzB,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CACdE,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC,CAC9BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBA,KAAK,CAAC,WAAW,EAAE,QAAQ,CAAC,CAC5BK,IAAI,CACHlJ,WAAW,KAAK,cAAc,GAC1B,SAAS,GACTA,WAAW,KAAK,kBAAkB,GAClC,aAAa,GACb,QACN,CAAC;MAEH,MAAMuL,UAAU,GAAG7C,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACD,IAAI,CAAC,WAAW,EAAE,aAAamB,MAAM,CAACI,IAAI,KAAK3B,MAAM,GAAG,EAAE,GAAG,CAAC;MAEjGgD,UAAU,CACP3C,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC;MAC3B0C,UAAU,CACP3C,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,UAAU,EAAE,UAAU,CAAC,CAC7BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBK,IAAI,CAAC,UAAU,CAAC;MAEnBqC,UAAU,CACP3C,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CACdA,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC;MAC3B0C,UAAU,CACP3C,MAAM,CAAC,MAAM,CAAC,CACdD,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,UAAU,EAAE,UAAU,CAAC,CAC7BA,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBK,IAAI,CAAC,UAAU,CAAC;MAEnB,MAAMsC,aAAa,GAAGzN,KAAK,CAAC0N,MAAM,CAAExD,CAAC,IAAKA,CAAC,CAACnI,WAAW,CAAC,KAAK4L,SAAS,IAAIzD,CAAC,CAACjI,WAAW,CAAC,KAAK0L,SAAS,CAAC;MAEvG,MAAMC,eAAe,GAAG1N,KAAK,CAACwN,MAAM,CAAE1C,IAAI,IAAK;QAC7C,MAAM6C,UAAU,GAAG7N,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAChD,MAAM,CAAC;QAC1D,MAAM8F,UAAU,GAAG9N,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAC/C,MAAM,CAAC;QAC1D,OAAO4F,UAAU,IAAIC,UAAU,IAAIA,UAAU,CAACrE,UAAU;MAC1D,CAAC,CAAC;MAEFmE,eAAe,CAAC/E,OAAO,CAAEmC,IAAI,IAAK;QAChC,MAAMhD,MAAM,GAAGhI,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAChD,MAAM,CAAC;QACtD,MAAMC,MAAM,GAAGjI,KAAK,CAACyF,IAAI,CAAEqE,CAAC,IAAKA,CAAC,CAACnE,EAAE,KAAKqF,IAAI,CAAC/C,MAAM,CAAC;QACtD,IAAID,MAAM,IAAIC,MAAM,EAAE;UACpB8C,CAAC,CAACF,MAAM,CAAC,MAAM,CAAC,CACbD,IAAI,CAAC,IAAI,EAAE0B,MAAM,CAACtE,MAAM,CAACjG,WAAW,CAAC,CAAC,CAAC,CACvC6I,IAAI,CAAC,IAAI,EAAE8B,MAAM,CAAC1E,MAAM,CAAC/F,WAAW,CAAC,CAAC,CAAC,CACvC2I,IAAI,CAAC,IAAI,EAAE0B,MAAM,CAACrE,MAAM,CAAClG,WAAW,CAAC,CAAC,CAAC,CACvC6I,IAAI,CAAC,IAAI,EAAE8B,MAAM,CAACzE,MAAM,CAAChG,WAAW,CAAC,CAAC,CAAC,CACvC6I,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC,CACvBA,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC;QAC7B;MACF,CAAC,CAAC;MAEF,MAAMG,UAAU,GAAGF,CAAC,CACjBN,SAAS,CAAC,aAAa,CAAC,CACxBvG,IAAI,CAACuJ,aAAa,CAAC,CACnBvC,KAAK,CAAC,CAAC,CACPL,MAAM,CAAC,GAAG,CAAC,CACXD,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC,CAC3BA,IAAI,CAAC,WAAW,EAAGV,CAAC,IAAK,aAAaoC,MAAM,CAACpC,CAAC,CAACnI,WAAW,CAAC,CAAC,KAAK2K,MAAM,CAACxC,CAAC,CAACjI,WAAW,CAAC,CAAC,GAAG,CAAC,CAC3F6I,KAAK,CAAC,QAAQ,EAAE,SAAS,CAAC,CAC1BO,EAAE,CAAC,YAAY,EAAErB,eAAe,CAAC,CACjCqB,EAAE,CAAC,YAAY,EAAEf,eAAe,CAAC,CACjCe,EAAE,CAAC,OAAO,EAAE,CAACpB,KAAK,EAAEC,CAAC,KAAKH,eAAe,CAACG,CAAC,CAAC,CAAC,CAC7CoD,IAAI,CACHlO,EAAE,CACC2O,IAAI,CAAC,CAAC,CACN1C,EAAE,CAAC,OAAO,EAAE,UAAUpB,KAAK,EAAEC,CAAC,EAAE;QAC/B,IAAIpJ,YAAY,IAAIE,YAAY,EAAE;QAClC5B,EAAE,CAAC+K,MAAM,CAAC,IAAI,CAAC,CAACE,KAAK,CAAC,CAAC;MACzB,CAAC,CAAC,CACDgB,EAAE,CAAC,MAAM,EAAE,UAAUpB,KAAK,EAAEC,CAAC,EAAE;QAC9B,IAAIpJ,YAAY,IAAIE,YAAY,EAAE;QAClC,MAAM,CAACgN,EAAE,EAAEC,EAAE,CAAC,GAAG7O,EAAE,CAAC8O,OAAO,CAACjE,KAAK,EAAEc,CAAC,CAACxF,IAAI,CAAC,CAAC,CAAC;QAC5CnG,EAAE,CAAC+K,MAAM,CAAC,IAAI,CAAC,CAACS,IAAI,CAAC,WAAW,EAAE,aAAaoD,EAAE,KAAKC,EAAE,GAAG,CAAC;QAC5D/D,CAAC,CAACiE,MAAM,GAAGH,EAAE;QACb9D,CAAC,CAACkE,MAAM,GAAGH,EAAE;MACf,CAAC,CAAC,CACD5C,EAAE,CAAC,KAAK,EAAE,UAAUpB,KAAK,EAAEC,CAAC,EAAE;QAC7B,IAAIpJ,YAAY,IAAIE,YAAY,EAAE;QAClC,IAAIqN,MAAM,GAAG,OAAOnE,CAAC,CAACiE,MAAM,KAAK,QAAQ,GAAGjE,CAAC,CAACiE,MAAM,GAAG/O,EAAE,CAAC8O,OAAO,CAACjE,KAAK,EAAEc,CAAC,CAACxF,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrF,IAAI+I,MAAM,GAAG,OAAOpE,CAAC,CAACkE,MAAM,KAAK,QAAQ,GAAGlE,CAAC,CAACkE,MAAM,GAAGhP,EAAE,CAAC8O,OAAO,CAACjE,KAAK,EAAEc,CAAC,CAACxF,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAErF,MAAMgJ,eAAe,GAAGjC,MAAM,CAACkC,MAAM,CAACH,MAAM,CAAC;QAC7C,MAAMI,eAAe,GAAG/B,MAAM,CAAC8B,MAAM,CAACF,MAAM,CAAC;QAE7C,MAAMI,eAAe,GAAGxE,CAAC,CAACnI,WAAW,CAAC;QACtC,MAAM4M,eAAe,GAAGzE,CAAC,CAACjI,WAAW,CAAC;QACtC,MAAM2M,MAAM,GAAGL,eAAe,GAAGG,eAAe;QAChD,MAAMG,MAAM,GAAGJ,eAAe,GAAGE,eAAe;QAEhD,OAAOzE,CAAC,CAACiE,MAAM;QACf,OAAOjE,CAAC,CAACkE,MAAM;QAEf,IAAI3F,aAAa,GAAG,EAAE;QACtB,IAAIqG,mBAAmB,GAAG,IAAI;QAE9B,IAAI3J,IAAI,CAAC4J,GAAG,CAACH,MAAM,CAAC,GAAG,CAAC,EAAE;UACxBnG,aAAa,CAACW,IAAI,CAAC;YACjBJ,MAAM,EAAEjH,WAAW;YACnBkH,SAAS,EAAE2F,MAAM,GAAG,CAAC,GAAG,UAAU,GAAG;UACvC,CAAC,CAAC;UACF,MAAMI,iBAAiB,GAAGhP,KAAK,CAC5B0N,MAAM,CAAEnI,IAAI,IAAKA,IAAI,CAACxD,WAAW,CAAC,KAAK4L,SAAS,IAAIpI,IAAI,CAACI,EAAE,KAAKuE,CAAC,CAACvE,EAAE,IAAIJ,IAAI,CAACxD,WAAW,CAAC,GAAGwM,eAAe,CAAC,CAC5GU,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACpN,WAAW,CAAC,GAAGmN,CAAC,CAACnN,WAAW,CAAC,CAAC;UAClD,IAAIiN,iBAAiB,CAAC,CAAC,CAAC,EAAE;YACxBF,mBAAmB,GAAGE,iBAAiB,CAAC,CAAC,CAAC;UAC5C;QACF;QAEA,IAAI7J,IAAI,CAAC4J,GAAG,CAACF,MAAM,CAAC,GAAG,CAAC,EAAE;UACxBpG,aAAa,CAACW,IAAI,CAAC;YACjBJ,MAAM,EAAE/G,WAAW;YACnBgH,SAAS,EAAE4F,MAAM,GAAG,CAAC,GAAG,UAAU,GAAG;UACvC,CAAC,CAAC;UACF,MAAMO,QAAQ,GAAGpP,KAAK,CACnB0N,MAAM,CAAEnI,IAAI,IAAKA,IAAI,CAACtD,WAAW,CAAC,KAAK0L,SAAS,IAAIpI,IAAI,CAACI,EAAE,KAAKuE,CAAC,CAACvE,EAAE,IAAIJ,IAAI,CAACtD,WAAW,CAAC,GAAGwM,eAAe,CAAC,CAC5GQ,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAAClN,WAAW,CAAC,GAAGiN,CAAC,CAACjN,WAAW,CAAC,CAAC;UAClD,IAAImN,QAAQ,CAAC,CAAC,CAAC,EAAE;YACfN,mBAAmB,GAAGM,QAAQ,CAAC,CAAC,CAAC,IAAIN,mBAAmB;UAC1D;QACF;QAEA1P,EAAE,CAAC+K,MAAM,CAAC,IAAI,CAAC,CAACS,IAAI,CAClB,WAAW,EACX,aAAa0B,MAAM,CAACpC,CAAC,CAACnI,WAAW,CAAC,CAAC,KAAK2K,MAAM,CAACxC,CAAC,CAACjI,WAAW,CAAC,CAAC,GAChE,CAAC;QAED,IAAIwG,aAAa,CAAC9D,MAAM,GAAG,CAAC,EAAE;UAC5B,MAAM0K,WAAW,GAAGjN,gBAAgB,CAAC,CAAC;UACtC,MAAMoG,SAAS,GAAG;YAChB,GAAG0B,CAAC;YACJvE,EAAE,EAAE0J,WAAW;YACf/H,CAAC,EAAE4C,CAAC,CAAC5C,CAAC;YACNC,CAAC,EAAE2C,CAAC,CAAC3C,CAAC;YACN,CAACxF,WAAW,GAAGwM,eAAe;YAC9B,CAACtM,WAAW,GAAGwM,eAAe;YAC9B9E,OAAO,EAAE,IAAI;YACbyB,gBAAgB,EAAE;UACpB,CAAC;UAEDnL,QAAQ,CAAEoI,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAEG,SAAS,CAAC,CAAC;UACxCrI,QAAQ,CAAEkI,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAE;YAAEL,MAAM,EAAEkC,CAAC,CAACvE,EAAE;YAAEsC,MAAM,EAAEoH;UAAY,CAAC,CAAC,CAAC;UAEpE7N,gBAAgB,CAAC;YACf+G,YAAY,EAAE2B,CAAC;YACf1B,SAAS;YACTC,aAAa;YACbC,UAAU,EAAEoG,mBAAmB;YAC/BQ,OAAO,EAAErF,KAAK,CAACsF,WAAW,CAACC,OAAO,GAAG,EAAE;YACvCC,OAAO,EAAExF,KAAK,CAACsF,WAAW,CAACG,OAAO,GAAG;UACvC,CAAC,CAAC;QACJ;MACF,CAAC,CACL,CAAC;MAEHzE,UAAU,CACPJ,MAAM,CAAC,QAAQ,CAAC,CAChBD,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CACZE,KAAK,CAAC,MAAM,EAAGZ,CAAC,IAAMA,CAAC,CAACkB,gBAAgB,GAAG,SAAS,GAAG9I,QAAQ,CAAC4H,CAAC,CAAC7C,IAAI,CAAE,CAAC,CACzEyD,KAAK,CAAC,SAAS,EAAGZ,CAAC,IAAMA,CAAC,CAACP,OAAO,GAAG,GAAG,GAAG,CAAE,CAAC,CAC9CmB,KAAK,CAAC,QAAQ,EAAGZ,CAAC,IAAK;QACtB,IAAI,CAAA5J,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEqF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,MAAM,CAAC,KACxC,IAAI,CAAAvF,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,MAAM,CAAC,KAC5C,OAAO,MAAM;MACpB,CAAC,CAAC,CACDmF,KAAK,CAAC,cAAc,EAAGZ,CAAC,IAAK;QAC5B,IAAI,CAAA5J,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEqF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,CAAC,CAAC,KACnC,IAAI,CAAAvF,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEuF,EAAE,MAAKuE,CAAC,CAACvE,EAAE,EAAE,OAAO,CAAC,CAAC,KACvC,OAAO,CAAC;MACf,CAAC,CAAC;IACN;EACF,CAAC,EAAE,CACD7F,QAAQ,EACRE,KAAK,EACLE,KAAK,EACLI,YAAY,EACZF,WAAW,EACX2B,WAAW,EACXE,WAAW,EACXnB,YAAY,EACZE,YAAY,CACb,CAAC;;EAEF;EACA,MAAM2O,MAAM,GAAGA,CAAA,KAAM;IACnB,MAAMC,eAAe,gBACnBrQ,OAAA;MACEgL,KAAK,EAAC,IAAI;MACVC,MAAM,EAAC,IAAI;MACXqF,OAAO,EAAC,WAAW;MACnBC,IAAI,EAAC,MAAM;MACXC,KAAK,EAAC,4BAA4B;MAClCjF,KAAK,EAAE;QAAEkF,WAAW,EAAE;MAAM,CAAE;MAAAC,QAAA,gBAE9B1Q,OAAA;QAAG2Q,QAAQ,EAAC,qBAAqB;QAAAD,QAAA,gBAC/B1Q,OAAA;UACE2K,CAAC,EAAC,mNAAmN;UACrNiG,MAAM,EAAC,SAAS;UAChBC,WAAW,EAAC,GAAG;UACfC,cAAc,EAAC;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,eACFlR,OAAA;UACE2K,CAAC,EAAC,gHAAgH;UAClHiG,MAAM,EAAC,SAAS;UAChBC,WAAW,EAAC,GAAG;UACfM,aAAa,EAAC,OAAO;UACrBL,cAAc,EAAC;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,eACFlR,OAAA;UACE2K,CAAC,EAAC,iCAAiC;UACnCiG,MAAM,EAAC,SAAS;UAChBC,WAAW,EAAC,GAAG;UACfM,aAAa,EAAC,OAAO;UACrBL,cAAc,EAAC;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eACJlR,OAAA;QAAA0Q,QAAA,eACE1Q,OAAA;UAAUoG,EAAE,EAAC,eAAe;UAAAsK,QAAA,eAC1B1Q,OAAA;YAAMgL,KAAK,EAAC,IAAI;YAACC,MAAM,EAAC,IAAI;YAACsF,IAAI,EAAC,OAAO;YAACa,SAAS,EAAC;UAA8B;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC7E;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACP,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CACN;IAED,MAAMG,cAAc,gBAClBrR,OAAA;MACEgL,KAAK,EAAC,IAAI;MACVC,MAAM,EAAC,IAAI;MACXqF,OAAO,EAAC,WAAW;MACnBC,IAAI,EAAC,MAAM;MACXC,KAAK,EAAC,4BAA4B;MAClCjF,KAAK,EAAE;QAAEkF,WAAW,EAAE;MAAM,CAAE;MAAAC,QAAA,eAE9B1Q,OAAA;QAAA0Q,QAAA,gBACE1Q,OAAA;UACE2K,CAAC,EAAC,kCAAkC;UACpCiG,MAAM,EAAC,SAAS;UAChBC,WAAW,EAAC,GAAG;UACfM,aAAa,EAAC,OAAO;UACrBL,cAAc,EAAC;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,eACFlR,OAAA;UACEsR,QAAQ,EAAC,SAAS;UAClBC,QAAQ,EAAC,SAAS;UAClB5G,CAAC,EAAC,iNAAiN;UACnN4F,IAAI,EAAC;QAAS;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC,eACFlR,OAAA;UACEsR,QAAQ,EAAC,SAAS;UAClBC,QAAQ,EAAC,SAAS;UAClB5G,CAAC,EAAC,iNAAiN;UACnN4F,IAAI,EAAC;QAAS;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC,eACFlR,OAAA;UACEsR,QAAQ,EAAC,SAAS;UAClBC,QAAQ,EAAC,SAAS;UAClB5G,CAAC,EAAC,iNAAiN;UACnN4F,IAAI,EAAC;QAAS;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC,eACFlR,OAAA;UACEsR,QAAQ,EAAC,SAAS;UAClBC,QAAQ,EAAC,SAAS;UAClB5G,CAAC,EAAC,gNAAgN;UAClN4F,IAAI,EAAC;QAAS;UAAAQ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACf,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CACN;IAED,MAAMM,QAAQ,GAAG;MACfC,OAAO,EAAE,MAAM;MACfC,UAAU,EAAE,QAAQ;MACpBC,OAAO,EAAE,WAAW;MACpBC,MAAM,EAAE,SAAS;MACjBC,YAAY,EAAE,QAAQ;MACtBC,UAAU,EAAE,eAAe;MAC3BC,QAAQ,EAAE,UAAU;MACpBC,UAAU,EAAE;IACd,CAAC;IAED,MAAMC,sBAAsB,GAAG1R,QAAQ,GACnC;MAAE2R,eAAe,EAAE,MAAM;MAAEC,KAAK,EAAE;IAAU,CAAC,GAC7C;MAAED,eAAe,EAAE,aAAa;MAAEC,KAAK,EAAE;IAAU,CAAC;IAExD,MAAMC,qBAAqB,GAAG,CAAC7R,QAAQ,GACnC;MAAE2R,eAAe,EAAE,MAAM;MAAEC,KAAK,EAAE;IAAU,CAAC,GAC7C;MAAED,eAAe,EAAE,aAAa;MAAEC,KAAK,EAAE;IAAU,CAAC;IAExD,oBACEnS,OAAA;MACEuL,KAAK,EAAE;QACLkG,OAAO,EAAE,MAAM;QACfC,UAAU,EAAE,QAAQ;QACpBQ,eAAe,EAAE,SAAS;QAC1BP,OAAO,EAAE;MACX,CAAE;MAAAjB,QAAA,gBAGF1Q,OAAA;QAAKuL,KAAK,EAAE;UAAE,GAAGiG,QAAQ;UAAE,GAAGS,sBAAsB;UAAExB,WAAW,EAAE;QAAM,CAAE;QAAC4B,OAAO,EAAEA,CAAA,KAAM7R,WAAW,CAAC,IAAI,CAAE;QAAAkQ,QAAA,GAC1GL,eAAe,EAAC,kBAEnB;MAAA;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAGNlR,OAAA;QAAKuL,KAAK,EAAE;UAAE,GAAGiG,QAAQ;UAAE,GAAGY;QAAsB,CAAE;QAACC,OAAO,EAAEA,CAAA,KAAM7R,WAAW,CAAC,KAAK,CAAE;QAAAkQ,QAAA,GACtFW,cAAc,EAAC,iBAElB;MAAA;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV,CAAC;;EAED;;EAEA,MAAMoB,cAAc,GAAGA,CAAC;IAAEtM,IAAI;IAAEuM,SAAS;IAAEC;EAAa,CAAC,KAAK;IAC5D,MAAMC,WAAW,GAAG,CAAC,CAACzM,IAAI,CAACmE,aAAa;IACxC;IACA,MAAM5H,OAAO,GAAGkQ,WAAW,IAAI,CAACF,SAAS,GACrCvM,IAAI,CAACmE,aAAa,CAAC5H,OAAO,GAC1ByD,IAAI,CAACzD,OAAO;IAEhB,oBACEvC,OAAA;MACEuL,KAAK,EAAE;QACLmH,MAAM,EAAE,mBAAmB;QAC3Bb,YAAY,EAAE,KAAK;QACnBF,OAAO,EAAE,MAAM;QACfgB,YAAY,EAAE,MAAM;QACpBC,QAAQ,EAAE,UAAU,CAAE;MACxB,CAAE;MAAAlC,QAAA,GAGD+B,WAAW,iBACVzS,OAAA;QACEqS,OAAO,EAAEA,CAAA,KAAMG,YAAY,CAAE1J,IAAI,IAAK,CAACA,IAAI,CAAE;QAC7CyC,KAAK,EAAE;UACLqH,QAAQ,EAAE,UAAU;UACpBnG,GAAG,EAAE,MAAM;UACXC,KAAK,EAAE,MAAM;UACbiF,OAAO,EAAE,SAAS;UAClBE,YAAY,EAAE,QAAQ;UACtBa,MAAM,EAAE,MAAM;UACdd,MAAM,EAAE,SAAS;UACjBM,eAAe,EAAE,SAAS;UAC1BH,QAAQ,EAAE,SAAS;UACnBC,UAAU,EAAE;QACd,CAAE;QAAAtB,QAAA,EAED6B,SAAS,GAAG,2BAA2B,GAAG;MAA2B;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnE,CACN,eAEDlR,OAAA;QACEuL,KAAK,EAAE;UACLwG,QAAQ,EAAE,SAAS;UACnBC,UAAU,EAAE,KAAK;UACjBW,YAAY,EAAE;QAChB,CAAE;QAAAjC,QAAA,EAED1K,IAAI,CAAC1D,KAAK,IAAI;MAAU;QAAAyO,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB,CAAC,eAGLlR,OAAA;QACEuL,KAAK,EAAE;UACLwG,QAAQ,EAAE,SAAS;UACnBc,UAAU,EAAE,KAAK;UACjBV,KAAK,EAAE;QACT,CAAE;QAAAzB,QAAA,EAEDnO;MAAO;QAAAwO,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV,CAAC;;EAEH;EACA,MAAM4B,8BAA8B,GAAGA,CAAC;IAAE9M,IAAI;IAAEvE,YAAY;IAAE8Q;EAAU,CAAC,KAAK;IAC5E;IACA,MAAMQ,YAAY,GAAG,SAAS;IAC9B,MAAMC,gBAAgB,GAAG,SAAS;IAClC,MAAMC,WAAW,GAAG,SAAS;IAE7B,MAAMC,SAAS,GAAG,CAAC,CAAClN,IAAI,CAACmE,aAAa;IAEtC,IAAI1I,YAAY,EAAE;MAChB,oBACEzB,OAAA;QAAKuL,KAAK,EAAE;UAAEoH,YAAY,EAAE;QAAO,CAAE;QAAAjC,QAAA,eACnC1Q,OAAA;UAAGuL,KAAK,EAAE;YAAEwG,QAAQ,EAAE,UAAU;YAAEI,KAAK,EAAE;UAAU,CAAE;UAAAzB,QAAA,EAAC;QAEtD;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAEV;;IAEA;IACA,MAAM5K,YAAY,GAAGiM,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACM,YAAY,GAAGN,IAAI,CAACmE,aAAa,CAAC7D,YAAY;IAClG,MAAME,gBAAgB,GAAG+L,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACQ,gBAAgB,GAAGR,IAAI,CAACmE,aAAa,CAAC3D,gBAAgB;IAC9G,MAAME,WAAW,GAAG6L,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACU,WAAW,GAAGV,IAAI,CAACmE,aAAa,CAACzD,WAAW;IAE/F,MAAME,aAAa,GAAG2L,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACY,aAAa,GAAGZ,IAAI,CAACmE,aAAa,CAACvD,aAAa;IACrG,MAAME,iBAAiB,GAAGyL,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACc,iBAAiB,GAAGd,IAAI,CAACmE,aAAa,CAACrD,iBAAiB;IACjH,MAAME,YAAY,GAAGuL,SAAS,IAAI,CAACW,SAAS,GAAGlN,IAAI,CAACgB,YAAY,GAAGhB,IAAI,CAACmE,aAAa,CAACnD,YAAY;;IAElG;IACA,oBACEhH,OAAA,CAAAE,SAAA;MAAAwQ,QAAA,gBAEE1Q,OAAA,CAACmT,WAAW;QACVC,KAAK,EAAC,SAAS;QACfjB,KAAK,EAAEY,YAAa;QACpBpN,KAAK,EAAEW,YAAa;QACpB+M,MAAM,EAAEzM,aAAc;QACtB0M,SAAS,EAAEJ,SAAS,GAAGlN,IAAI,CAACmE,aAAa,CAAC7D,YAAY,GAAG,IAAK;QAC9DiN,QAAQ,EAAEvN,IAAI,CAACM,YAAa;QAC5BiM,SAAS,EAAEA;MAAU;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eAGFlR,OAAA,CAACmT,WAAW;QACVC,KAAK,EAAC,aAAa;QACnBjB,KAAK,EAAEa,gBAAiB;QACxBrN,KAAK,EAAEa,gBAAiB;QACxB6M,MAAM,EAAEvM,iBAAkB;QAC1BwM,SAAS,EAAEJ,SAAS,GAAGlN,IAAI,CAACmE,aAAa,CAAC3D,gBAAgB,GAAG,IAAK;QAClE+M,QAAQ,EAAEvN,IAAI,CAACQ,gBAAiB;QAChC+L,SAAS,EAAEA;MAAU;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eAGFlR,OAAA,CAACmT,WAAW;QACVC,KAAK,EAAC,QAAQ;QACdjB,KAAK,EAAEc,WAAY;QACnBtN,KAAK,EAAEe,WAAY;QACnB2M,MAAM,EAAErM,YAAa;QACrBsM,SAAS,EAAEJ,SAAS,GAAGlN,IAAI,CAACmE,aAAa,CAACzD,WAAW,GAAG,IAAK;QAC7D6M,QAAQ,EAAEvN,IAAI,CAACU,WAAY;QAC3B6L,SAAS,EAAEA;MAAU;QAAAxB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC;IAAA,eACF,CAAC;EAEP,CAAC;EAED,MAAMiC,WAAW,GAAGA,CAAC;IAAEC,KAAK;IAAEjB,KAAK;IAAExM,KAAK;IAAE0N,MAAM;IAAEC,SAAS;IAAEC,QAAQ;IAAEhB;EAAU,CAAC,KAAK;IACvF,MAAMiB,WAAW,GAAGA,CAACF,SAAS,EAAEC,QAAQ,KAAK;MAC3C,MAAM3D,CAAC,GAAG6D,UAAU,CAACH,SAAS,CAAC;MAC/B,MAAM3D,CAAC,GAAG8D,UAAU,CAACF,QAAQ,CAAC;MAC9B,IAAIG,KAAK,CAAC9D,CAAC,CAAC,IAAI8D,KAAK,CAAC/D,CAAC,CAAC,EAAE,OAAO,IAAI;MAErC,IAAIA,CAAC,GAAGC,CAAC,EAAE;QACT;QACA,oBACE5P,OAAA;UACEgL,KAAK,EAAC,IAAI;UACVC,MAAM,EAAC,IAAI;UACXqF,OAAO,EAAC,WAAW;UACnBC,IAAI,EAAC,MAAM;UACXC,KAAK,EAAC,4BAA4B;UAClCjF,KAAK,EAAE;YAAEiB,MAAM,EAAE;UAAQ,CAAE;UAAAkE,QAAA,eAE3B1Q,OAAA;YAAA0Q,QAAA,gBACE1Q,OAAA;cACE2K,CAAC,EAAC,kDAAkD;cACpDiG,MAAM,EAAC,SAAS;cAChBC,WAAW,EAAC,GAAG;cACfM,aAAa,EAAC,OAAO;cACrBL,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvB,CAAC,eACFlR,OAAA;cACE2K,CAAC,EAAC,kCAAkC;cACpCiG,MAAM,EAAC,SAAS;cAChBC,WAAW,EAAC,GAAG;cACfM,aAAa,EAAC,OAAO;cACrBL,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAEV,CAAC,MAAM,IAAIvB,CAAC,GAAGC,CAAC,EAAE;QAChB;QACA,oBACE5P,OAAA;UACEgL,KAAK,EAAC,IAAI;UACVC,MAAM,EAAC,IAAI;UACXqF,OAAO,EAAC,WAAW;UACnBC,IAAI,EAAC,MAAM;UACXC,KAAK,EAAC,4BAA4B;UAClCjF,KAAK,EAAE;YAAEiB,MAAM,EAAE;UAAQ,CAAE;UAAAkE,QAAA,eAE3B1Q,OAAA;YAAA0Q,QAAA,gBACE1Q,OAAA;cACE2K,CAAC,EAAC,iCAAiC;cACnCiG,MAAM,EAAC,SAAS;cAChBC,WAAW,EAAC,GAAG;cACfM,aAAa,EAAC,OAAO;cACrBL,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvB,CAAC,eACFlR,OAAA;cACE2K,CAAC,EAAC,kCAAkC;cACpCiG,MAAM,EAAC,SAAS;cAChBC,WAAW,EAAC,GAAG;cACfM,aAAa,EAAC,OAAO;cACrBL,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAEV,CAAC,MAAM;QACL;QACA,oBACElR,OAAA;UACEgL,KAAK,EAAC,IAAI;UACVC,MAAM,EAAC,IAAI;UACXqF,OAAO,EAAC,WAAW;UACnBC,IAAI,EAAC,MAAM;UACXC,KAAK,EAAC,4BAA4B;UAClCjF,KAAK,EAAE;YAAEiB,MAAM,EAAE;UAAQ,CAAE;UAAAkE,QAAA,eAE3B1Q,OAAA;YAAGoG,EAAE,EAAC,OAAO;YAAAsK,QAAA,eACX1Q,OAAA;cACEoG,EAAE,EAAC,QAAQ;cACXuE,CAAC,EAAC,kCAAkC;cACpCiG,MAAM,EAAC,SAAS;cAChBC,WAAW,EAAC,GAAG;cACfM,aAAa,EAAC,OAAO;cACrBL,cAAc,EAAC;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACvB;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACD;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAEV;IACF,CAAC;IAED,MAAMgC,SAAS,GAAGI,SAAS,KAAK,IAAI;IACpC,IAAIK,YAAY;IAChB,IAAIT,SAAS,EAAE;MACbS,YAAY,gBACV3T,OAAA;QAAKuL,KAAK,EAAE;UAAEkG,OAAO,EAAE,MAAM;UAAEC,UAAU,EAAE,QAAQ;UAAEK,QAAQ,EAAE,MAAM;UAAEI,KAAK,EAAE;QAAU,CAAE;QAAAzB,QAAA,gBACxF1Q,OAAA;UAAA0Q,QAAA,EAAO4C;QAAS;UAAAvC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,EACvBsC,WAAW,CAACF,SAAS,EAAEC,QAAQ,CAAC,eACjCvT,OAAA;UAAA0Q,QAAA,EAAO6C;QAAQ;UAAAxC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpB,CACN;IACH,CAAC,MAAM;MACLyC,YAAY,gBACV3T,OAAA;QAAKuL,KAAK,EAAE;UAAEwG,QAAQ,EAAE,MAAM;UAAEI,KAAK,EAAE;QAAU,CAAE;QAAAzB,QAAA,GAAC,SAC3C,EAAC/K,KAAK;MAAA;QAAAoL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACV,CACN;IACH;IAEA,oBACElR,OAAA;MACEuL,KAAK,EAAE;QACL2G,eAAe,EAAE,SAAS;QAC1BQ,MAAM,EAAE,mBAAmB;QAC3Bb,YAAY,EAAE,KAAK;QACnBF,OAAO,EAAE,MAAM;QACfgB,YAAY,EAAE;MAChB,CAAE;MAAAjC,QAAA,gBAEF1Q,OAAA;QAAKuL,KAAK,EAAE;UAAEkG,OAAO,EAAE,MAAM;UAAEC,UAAU,EAAE,QAAQ;UAAEiB,YAAY,EAAE;QAAM,CAAE;QAAAjC,QAAA,gBACzE1Q,OAAA;UACEuL,KAAK,EAAE;YACLP,KAAK,EAAE,MAAM;YACbC,MAAM,EAAE,MAAM;YACd4G,YAAY,EAAE,KAAK;YACnBK,eAAe,EAAEC,KAAK;YACtB1B,WAAW,EAAE;UACf;QAAE;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACFlR,OAAA;UAAKuL,KAAK,EAAE;YAAEwG,QAAQ,EAAE,MAAM;YAAEC,UAAU,EAAE,KAAK;YAAE4B,YAAY,EAAE,KAAK;YAAEzB;UAAM,CAAE;UAAAzB,QAAA,EAAE0C;QAAK;UAAArC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,EAACyC,YAAY;MAAA;QAAA5C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxG,CAAC,eACNlR,OAAA;QACEuL,KAAK,EAAE;UACLwG,QAAQ,EAAE,UAAU;UACpBI,KAAK,EAAE,SAAS;UAChBU,UAAU,EAAE,KAAK;UACjBF,YAAY,EAAE,MAAM;UACpBkB,UAAU,EAAE;QACd,CAAE;QAAAnD,QAAA,EAED2C,MAAM,IAAI;MAAsB;QAAAtC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9B,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV,CAAC;EAED,MAAM4C,SAAS,GAAGA,CAAC;IAAE9N,IAAI;IAAEvE,YAAY;IAAElB;EAAS,CAAC,KAAK;IAAAF,EAAA;IACtD;IACA,MAAM,CAACkS,SAAS,EAAEC,YAAY,CAAC,GAAG9S,QAAQ,CAAC,IAAI,CAAC;IAEhD,IAAI,CAACsG,IAAI,EAAE;MACT,oBACEhG,OAAA;QACEuL,KAAK,EAAE;UACLoG,OAAO,EAAE,MAAM;UACfF,OAAO,EAAE,MAAM;UACfC,UAAU,EAAE,QAAQ;UACpBqC,cAAc,EAAE,QAAQ;UACxB9I,MAAM,EAAE,OAAO;UACfkH,KAAK,EAAE;QACT,CAAE;QAAAzB,QAAA,eAEF1Q,OAAA;UAAA0Q,QAAA,EAAG;QAA+B;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnC,CAAC;IAEV;;IAEA;IACA;;IAEA;MAAA;MACE;MACAlR,OAAA;QACEuL,KAAK,EAAE;UACLmH,MAAM,EAAE,mBAAmB;UAC3Bb,YAAY,EAAE,KAAK;UACnBK,eAAe,EAAE,SAAS;UAC1BP,OAAO,EAAE;QACX,CAAE;QAAAjB,QAAA,gBAqBF1Q,OAAA,CAACsS,cAAc;UAACtM,IAAI,EAAEA,IAAK;UAACuM,SAAS,EAAEA,SAAU;UAACC,YAAY,EAAEA;QAAa;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAGhFlR,OAAA,CAAC8S,8BAA8B;UAC7B9M,IAAI,EAAEA,IAAK;UACXvE,YAAY,EAAEA,YAAa;UAC3B8Q,SAAS,EAAEA;QAAU;UAAAxB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtB,CAAC,EAED3Q,QAAQ;QAAA;QACP;QACAP,OAAA,CAACgU,sBAAsB;UAAAjD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,GACxB,IAAI;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL;IAAC;EAEV,CAAC;;EAEC;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAAA7Q,EAAA,CAzLIyT,SAAS;EA2Lb,MAAMG,yBAAyB,GAAG,MAAO5M,CAAC,IAAK;IAC7CA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI,CAAClF,gBAAgB,CAACE,KAAK,CAACwC,IAAI,CAAC,CAAC,IAAI,CAAC1C,gBAAgB,CAACG,OAAO,CAACuC,IAAI,CAAC,CAAC,EAAE;IAExEtD,eAAe,CAAC,IAAI,CAAC;IACrBI,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMsS,KAAK,GAAGrR,gBAAgB,CAAC,CAAC;MAChC,MAAMwH,aAAa,GAAG;QACpBjE,EAAE,EAAE8N,KAAK;QACT,GAAG9R;MACL,CAAC;;MAED;MACA,MAAMuF,qBAAqB,GAAG,CAAC,GAAG7F,cAAc,EAAEuI,aAAa,CAAC;MAChEtI,iBAAiB,CAAC4F,qBAAqB,CAAC;;MAExC;MACA,MAAMwM,OAAO,GAAG;QACd/N,EAAE,EAAE8N,KAA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}